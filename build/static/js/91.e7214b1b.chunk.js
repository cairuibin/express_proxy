(this.webpackJsonpzjyz_admin=this.webpackJsonpzjyz_admin||[]).push([[91],{1763:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIDSURBVHgB5ZZNbtNAGIbfGRvjHT6Cl1VFg7NmQeYG4QQQiQ1KJZQTkJzARVWarW+Q9ARTfvY1RUJdhht42STN9zFua2rS4mby0w2PZOWzR8pjj795xwI37Oo4cqU3NGWIzTG+JLz+qdppcUEWxRZkOaErMSxfuBJGehBuQfZHekf4mDy60K0Yy5g5hSVCiAZWEUqS9VS9H8OSFyf9IQs0YSskcHNHD0awhAVFVeP/nlLJsQeOsWH+5y4lfGLMrbpUQAaQ4qMpA9gKHe9pfPry3S9Ysvel/0pwqUsJvaWE88vJqKYPj2EBO84zwVyScedM7R8sJTREkLKyxRcxsls5ofVD7Sd5vaPjMP89V52xiy1wLWsneR3pOCD55NTcTlD7OuhWRhvYHLYyRq+Q1b4dvbmYTT57+XuUiEHUrYg2qLS0cdqSyzDnxJOeORNvmbglTAdXRJtomGhb+gnPS7lbyG5H+WCGad2nYLSZaLtu/e79shyR+fCRqla2ftIY2ZlqdytkY0lCFTvPekJL2XrCkmxPHzXvypAtylYWmugaFbJd3Y9mmKSm5Xt/y6Du28BXWvjM9L2oHUfELnvhlKbKI/N3Un6oWlI3wgvT/h7WIDTrTUua1kF+UvVpcjWlqepkC1OyNGJOxyZdEnOcAH7w0HeQKJ8814cNAQ7xAA6cdNUU+g3vDey8IQNI6AAAAABJRU5ErkJggg=="},1784:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADRSURBVHgB3VK7DcIwEL2X0EOLaLIBbJCwAYxAA3SwAcoIdAghITbICEZiD9wBFSxgH+cIF4lIIoWOV/ikex9b8iP6AXDHfRFfZURgeskms8ac+oeL8qLbMhHOrkQ+cTq3Y4OxN/OXYM3WpggwFNO6TAo361A1IgTBsYanoI40jKl7QSvzYK8yZj63MjfhX80AulVc3T/TYx4/pT29BjNv5Q5pUi4ceZJRNLr6yk7L1ByGCuU012MZCZg39OmxQDGQ9ndKFcKoAnmIoYRC0mWTxxvRakPLz0XtsQAAAABJRU5ErkJggg=="},1801:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAARCAYAAAACCvahAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFUSURBVHgBpZI9S8NAGMf/dyapSUq7qDiUIji7COLky+as4Gx3Bb+Djn4EQfwA4qaCm0KXLg6li1AUtWCbIiptbZJLHi/xNbZpK/3BvTzH87vn7jhgCFjQ7eRrOc7ZlgyNbkmu8OxiubJ9nJu97JB389Y9Y8jEVXBcgdJNpckYrR9tzJ19rfNwhx7iTwmYROx09aCwFJH7oSkKUob+IXB+snZYWAzmCgZkOjOBtuMCBNMnf08uzQ8sB4xqaiSOlZezJrIpFbWWQLUpYAtC+dmB7dF3Du8uGhjTR3Bx1wzHpMqhqwypRDQ9EukyaSFjyIpaGM+MJ0Jh0lTw8OrCannxclrjaLg+6vKoaSmNcIb6m4fz2waqf8SOOz/KuwXt6rPqVFpFyXLwYvvoRuyDFS07bL0Y6JN0QL9lwjX+A6OnYAiPLbhYUUjZlNNkP48I1Tbj+xiWd3zIb66gtz8RAAAAAElFTkSuQmCC"},2401:function(e,t,a){},2755:function(e,t,a){"use strict";a.r(t);a(67);var s=a(28),r=a.n(s),i=a(3),n=a.n(i),c=a(7),o=a(9),l=a(12),m=a(52),u=a(11),d=a(10),g=(a(178),a(82)),p=a.n(g),y=a(0),h=a.n(y),A=(a(2401),a(522)),f=(a(239),a(111)),N=a(75),E=(a(943),p.a.TreeNode),I=p.a.DirectoryTree,v=function(e){Object(u.a)(s,e);var t=Object(d.a)(s);function s(){var e;Object(o.a)(this,s);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={userId:"",courseTree:[],resourceId:"",resourceDetail:{},imgArr:[],isTxt:!1,planNum:0,filImgH:0,duration:1,studyProgressSecond:1,progress:0,enterTime:null,loadNum:0},e.goBack=function(){e.props.history.goBack()},e.scrollPic=function(){Object(m.a)(e);var t=document.getElementById("img_content"),a=document.getElementById("pic_parent"),s=(t.offsetHeight,a.scrollTop),r=e.state.filImgH,i=parseInt(s/r);e.setState({planNum:i+1})},e.imgLoad=function(t){var a=e.state,s=(a.filImgH,a.planNum,a.progress),r=document.getElementById("img_content"),i=document.getElementById("pic_parent");if(null!=document.getElementById("file_img0")){var n=document.getElementById("file_img0").offsetHeight;r.offsetHeight;e.setState({filImgH:n},(function(){e.state.imgArr.length-1>t&&e.setState({loadNum:e.state.loadNum+1},(function(){e.state.imgArr.length-1==e.state.loadNum&&(i.scrollTop=n*s-n)}))}))}},e}return Object(l.a)(s,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.search.split("?")[1],a=t.includes("%")?decodeURI(t):t,s=JSON.parse(a),r=localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).user.id:"";this.setState({userId:r,courseId:s.courseId,resourceId:s.resourceId,enterTime:(new Date).getTime()},(function(){e.init(s,r)}))}},{key:"init",value:function(){var e=Object(c.a)(n.a.mark((function e(t,a){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getResourceLearning();case 2:return e.next=4,this.getOne(t.resourceId);case 4:this.getFileUrl(),this.myStudyCourseCatalog(t.courseId,a);case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getOne",value:function(){var e=Object(c.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(A.g)({id:t});case 2:a=e.sent,this.setState({resourceDetail:a,resourceId:a.id});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getResourceLearning",value:function(){var e=Object(c.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(A.i)({resourceId:this.state.resourceId,studentId:this.state.userId,resourceFrom:2});case 2:t=e.sent,this.setState({progress:t.studyProgressSecond?t.studyProgressSecond:0});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"myStudyCourseCatalog",value:function(){var e=Object(c.a)(n.a.mark((function e(t,a){var s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(A.m)({subjectId:t,userId:a});case 2:s=e.sent,this.setState({courseTree:s.bookCatalogVoList});case 4:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getCutOne",value:function(){var e=Object(c.a)(n.a.mark((function e(t){var a,s,i,c,o,l=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==t.belongType){e.next=10;break}return this.recordLearningRate(),this.myStudyCourseCatalog(this.state.courseId,this.state.userId),e.next=5,Object(A.g)({id:t.id});case 5:a=e.sent,N.a.isEmpty(document.getElementById("previewIframe"))||(document.getElementById("previewIframe").innerHTML=""),this.setState({resourceDetail:a,resourceId:a.id},(function(){l.getFileUrl()})),e.next=11;break;case 10:2===t.belongType?(s=new Date,i=new Date(t.studyFromTime),c=new Date(t.studyEndTime),"1"===(o=t.publishAnswerType)?s<i?r.a.info({getContainer:document.getElementById("Catalogue-pic"),className:"Catalogue-pic-modal",title:"\u63d0\u793a",content:"\u4f5c\u4e1a\u672a\u5f00\u59cb"}):s>c&&3!==t.homeworkStatus?r.a.info({getContainer:document.getElementById("Catalogue-pic"),className:"Catalogue-pic-modal",title:"\u63d0\u793a",content:"\u4f5c\u4e1a\u5df2\u7ed3\u675f"}):s>c&&3===t.homeworkStatus&&1===t.dealStatus?this.props.history.push("/my-operation/operation-finished/".concat(o,"/").concat(t.id)):s>c&&3===t.homeworkStatus&&2===t.dealStatus?this.props.history.push("/my-operation/operation-message/".concat(o,"/").concat(t.id)):s<c&&3!==t.homeworkStatus?this.props.history.push("/operation-begin/".concat(t.id)):s<c&&3===t.homeworkStatus?this.props.history.push("/my-operation/operation-reviewed/".concat(o,"/").concat(t.id)):r.a.info({getContainer:document.getElementById("Catalogue-pic"),className:"Catalogue-pic-modal",title:"\u63d0\u793a",content:"\u4f5c\u4e1a\u5df2\u7ed3\u675f"}):s<i?r.a.info({getContainer:document.getElementById("Catalogue-pic"),className:"Catalogue-pic-modal",title:"\u63d0\u793a",content:"\u4f5c\u4e1a\u672a\u5f00\u59cb"}):s>c&&3!==t.homeworkStatus?r.a.info({getContainer:document.getElementById("Catalogue-pic"),className:"Catalogue-pic-modal",title:"\u63d0\u793a",content:"\u4f5c\u4e1a\u5df2\u7ed3\u675f"}):s<c&&3!==t.homeworkStatus?this.props.history.push("/operation-begin/".concat(t.id,"/").concat(this.state.courseId)):3===t.homeworkStatus&&1===t.dealStatus?this.props.history.push("/my-operation/operation-finished/".concat(o,"/").concat(t.id)):3===t.homeworkStatus&&2===t.dealStatus?this.props.history.push("/my-operation/operation-message/".concat(o,"/").concat(t.id)):r.a.info({getContainer:document.getElementById("Catalogue-pic"),className:"Catalogue-pic-modal",title:"\u63d0\u793a",content:"\u4f5c\u4e1a\u5df2\u7ed3\u675f"})):r.a.info({getContainer:document.getElementById("my-learn-details-show"),className:"my-learn-details-show-modal",title:"\u63d0\u793a",content:"\u8bf7\u524d\u5f80\u624b\u673a\u7aef\u8fdb\u5165\u8bfe\u5802"});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFileUrl",value:function(){var e=this.state,t=e.resourceDetail,a=(e.isTxt,document.documentElement.clientHeight-220);if(5===t.mediaType||4===t.mediaType){var s=document.getElementById("previewVideo");s.src="".concat(f.f,"/").concat(t.filePath),s.play()}else if(9===t.mediaType){var r=document.createElement("iframe"),i={resourceName:t.resourceName,content:t.content};r.src="/#/student/safety-check?".concat(encodeURI(JSON.stringify(i))),r.width="100%",r.height=a+"px",r.parmas=i,document.getElementById("previewIframe").appendChild(r)}else if(1===t.mediaType||8===t.mediaType){var n="".concat(f.b,"&furl=").concat(f.d,"/api/media/api/v1/media/download/").concat(t.fileId),c=document.createElement("iframe");if(c.src=n,c.width="100%",c.id="iframeId",c.height=a+"px",!N.a.isEmpty(c)&&!N.a.isEmpty(document.getElementById("previewIframe"))){document.getElementById("previewIframe").appendChild(c);document.getElementById("iframeId").contentWindow.document.body;if(t&&t.resourceName){var o=t.resourceName.split("."),l=o.length-1,m=o&&o.length>0?o[l]:"";-1!==f.h.indexOf(m)?document.getElementById("previewIframe").style.background="#ffffff":"pdf"==m&&(document.getElementById("previewIframe").style.background="#E6E6E6")}}}else if(99===t.mediaType){var u=document.createElement("iframe"),d={resourceName:t.resourceName,content:t.content,fileId:t.fileId};u.src="/#/student/safety-down?".concat(encodeURI(JSON.stringify(d))),u.width="100%",u.height=a+"px",u.parmas=d,document.getElementById("previewIframe").appendChild(u)}}},{key:"recordLearningRate",value:function(){if(1===this.state.resourceDetail.mediaType||8===this.state.resourceDetail.mediaType)this.state.studyProgressSecond=1,this.state.duration=1;else if(4===this.state.resourceDetail.mediaType||5===this.state.resourceDetail.mediaType){var e=document.getElementById("previewVideo");this.state.studyProgressSecond=Math.floor(e.currentTime),this.state.duration=Math.floor(e.duration)}if(this.state.studyProgressSecond>0){var t=(new Date).getTime();this.state.studySumSecond=t-this.state.enterTime,Object(A.s)({duration:this.state.duration,mediaType:this.state.resourceDetail.mediaType,resourceFrom:2,studentId:this.state.userId,resourceId:this.state.resourceId,studyProgressSecond:this.state.studyProgressSecond,studySumSecond:this.state.studySumSecond/1e3})}}},{key:"componentWillUnmount",value:function(){this.recordLearningRate()}},{key:"render",value:function(){var e=this,t=this.state,s=t.courseTree,r=t.resourceDetail,i=t.resourceId,n=(t.isTxt,t.imgArr,document.documentElement.clientHeight-220),c=function(e){if(!N.a.isEmpty(e))return h.a.createElement("div",null,2===e.belongType?h.a.createElement("img",{className:"user-img",src:a(1801),alt:""}):3===e.belongType?h.a.createElement("img",{className:"user-img",src:a(1784),alt:""}):1===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(525),alt:""}):2===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(533),alt:""}):3===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(526),alt:""}):4===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(534),alt:""}):5===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(527),alt:""}):6===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(528),alt:""}):7===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(529),alt:""}):8===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(530),alt:""}):9===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(531),alt:""}):99===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(524),alt:""}):0===e.mediaType?h.a.createElement("img",{className:"user-img",src:a(1763),alt:""}):"")};return h.a.createElement("div",{className:"my-learn-details-show clearfix",id:"my-learn-details-show"},h.a.createElement("div",{className:"details-show-pic clearfix"},h.a.createElement("div",{className:"top"},h.a.createElement("span",{className:"img",style:{width:"85px"}}," ",h.a.createElement("a",{className:"preview-f",onClick:this.goBack.bind(this)},h.a.createElement("img",{src:a(521),style:{float:"left"},alt:""}),h.a.createElement("span",{className:"text-back",style:{float:"left",fontSize:"16px",color:"#2A283D"}},"\u8fd4\u56de"))),r.title),h.a.createElement("div",{className:"preview-box clearfix"},h.a.createElement("div",{className:"left clearfix"},5===r.mediaType?h.a.createElement("video",{style:{width:"100%"},height:n,id:"previewVideo",src:"",controls:"controls",controlsList:"nodownload"}):4===r.mediaType?h.a.createElement("div",{className:"audio-flex",style:{height:n}},h.a.createElement("audio",{id:"previewVideo",src:"",controls:"controls",controlsList:"nodownload",className:"preview_audio"})):6===r.mediaType?h.a.createElement("div",{className:"pic_img",style:{height:n}},h.a.createElement("embed",{src:"/api/media/api/v1/media/getMedia/".concat(r.fileId,"/").concat(r.resourceName)})," "):3===r.mediaType?h.a.createElement("div",{className:"pic_img",style:{height:n}},h.a.createElement("img",{src:"/api/media/api/v1/media/getMedia/".concat(r.fileId),alt:"",className:"preview_img"})," "):h.a.createElement("div",{id:"previewIframe",style:{height:n}})," "),h.a.createElement("div",{className:"right clearfix"},h.a.createElement("span",{className:"span"},"\u8bfe\u7a0b\u76ee\u5f55:"),h.a.createElement("div",{className:"Catalogue-pic"},h.a.createElement("div",{className:"Catalogue-pic-tree",style:{height:n-40}},s&&s.length>0?h.a.createElement(I,{defaultExpandAll:!0,multiples:!0},function t(a){return a.map((function(a){return!N.a.isEmpty(a)&&a.hasOwnProperty("children")&&a.children?0===a.seniorId?h.a.createElement(E,{className:"TreeNode",key:a.id,title:h.a.createElement("div",{className:"TreeIcon"},h.a.createElement("span",{className:"title",style:{marginRight:10},title:a.catalogName},a.catalogName))},a.myStudyResourceVos.map((function(t,a){return h.a.createElement(E,{className:"ResourceTreeNode",key:a,title:h.a.createElement("div",{className:"TreeIcon"},".",c(t),h.a.createElement("span",{className:"title1",style:{marginRight:10},onClick:function(){return e.getCutOne(t)},title:t.resourceName},t.resourceName,t.id===i?h.a.createElement("i",{className:"i i-active"},"\u6b63\u5728\u5b66"):h.a.createElement("i",{className:"i"},t.studyProgressSum?(100*t.studyProgressSum).toFixed(0)+"%":"0%")))})})),t(a.children)):h.a.createElement(E,{className:"TreeNode",key:a.id,title:h.a.createElement("div",{className:"TreeIcon"},h.a.createElement("span",{className:"title",style:{marginRight:10},title:a.catalogName},a.catalogName))},a.myStudyResourceVos.map((function(t,a){return h.a.createElement(E,{className:"ResourceTreeNode",key:a,title:h.a.createElement("div",{className:"TreeIcon"},c(t),h.a.createElement("span",{className:"title1",style:{marginRight:10},onClick:function(){return e.getCutOne(t)},title:t.resourceName},t.resourceName,t.id===i?h.a.createElement("i",{className:"i i-active"},"\u6b63\u5728\u5b66"):h.a.createElement("i",{className:"i"},t.studyProgressSum?(100*t.studyProgressSum).toFixed(0)+"%":"0%")))})})),t(a.children)):(a.seniorId,h.a.createElement(E,{className:"TreeNode",key:a.id,title:h.a.createElement("div",{className:"TreeIcon"},h.a.createElement("span",{className:"title",style:{marginRight:10},title:a.catalogName},a.catalogName))},a.myStudyResourceVos.map((function(t,a){return h.a.createElement(E,{className:"ResourceTreeNode",key:a,title:h.a.createElement("div",{className:"TreeIcon"},c(t),h.a.createElement("span",{className:"title1",style:{marginRight:10},onClick:function(){return e.getCutOne(t)},title:t.resourceName},t.resourceName,t.id===i?h.a.createElement("i",{className:"i i-active"},"\u6b63\u5728\u5b66"):h.a.createElement("i",{className:"i"},t.studyProgressSum?(100*t.studyProgressSum).toFixed(0)+"%":"0%")))})}))))}))}(s)):null))))))}}]),s}(y.Component);t.default=v}}]);