(this.webpackJsonpzjyz_admin=this.webpackJsonpzjyz_admin||[]).push([[102],{1762:function(e,t,a){"use strict";a(41);var n,s=a(8),r=a.n(s),i=(a(317),a(206)),c=a.n(i),o=(a(45),a(6)),l=a.n(o),d=(a(276),a(83)),u=a.n(d),m=(a(67),a(28)),p=a.n(m),f=a(9),h=a(12),I=a(11),g=a(10),v=a(0),y=a.n(v),S=(a(1789),a(35)),E=a(1794),w=a(1791),k=a(239),b=a(520),N=(a.n(b)()(),Object(S.g)(n=function(e){Object(I.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).getClassRoom=function(){var e=n.state,t=e.classroomId,a=e.stepId;Object(k.s)([t,a]).then((function(e){e&&n.setState({classStatus:e.classStatus})}))},n.state={switchStatus:!0,classBtnContent:0==sessionStorage.getItem("stepId")?"\u8bfe\u524d\u9884\u4e60":2==sessionStorage.getItem("stepId")?"\u8bfe\u540e\u590d\u4e60":"\u8bfe\u5802\u6559\u5b66",stepId:sessionStorage.getItem("stepId")?sessionStorage.getItem("stepId"):1,courseId:"",classroomId:"",catalogId:"",classStatus:""},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.search.split("?")[1];if(t){var a=t.includes("%")?decodeURI(t):t,n=JSON.parse(a);this.setState({courseId:n.courseId,classroomId:n.classroomId,catalogId:n.catalogId,pathname:n.pathname,id:n.id,homeworkId:n.homeworkId},(function(){e.getClassRoom()}))}}},{key:"rightSwitch",value:function(){this.props.open({isOpen:!0})}},{key:"goBack",value:function(){var e=this.state,t=e.catalogId,a=e.courseId,n=e.classroomId,s=e.pathname,r=e.id,i=e.homeworkId,c={courseId:a,classroomId:n,catalogId:t};if(sessionStorage.removeItem("coursewareBack"),s)return r&&(c.id=r),i&&(c.homeworkId=i),void this.props.history.replace("".concat(s,"?").concat(encodeURI(JSON.stringify(c))));this.props.history.replace("/teching/projection-screen?".concat(encodeURI(JSON.stringify(c))))}},{key:"finishClass",value:function(){var e=this,t=this.state.classStatus,a=3==t?"\u786e\u5b9a\u8981\u9000\u51fa\u5417\uff1f":"\u786e\u5b9a\u8981\u4e0b\u8bfe\u5417\uff1f";p.a.confirm({title:"\u63d0\u793a",content:a,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",className:"ModalConfirm border_none",onOk:function(){if(2==t){var a={id:e.state.classroomId,releaseStatus:2,over:9};Object(k.j)(a).then((function(t){0==t.code&&(localStorage.setItem("changeClass",e.state.classroomId),e.props.history.replace("/"))}))}else 3==t&&e.props.history.replace("/")},onCancel:function(){}})}},{key:"render",value:function(){var e=this,t=this.state,a=t.courseId,n=t.classroomId,s=t.catalogId,r=t.classStatus,i=this.props.changeBtn;return y.a.createElement("div",null,this.props.goBackVis?"":y.a.createElement("p",{onClick:this.goBack.bind(this)},y.a.createElement("i",{className:"iconfont"},"\ue6ba"),"\u8fd4\u56de"),i?y.a.createElement("div",null," ",y.a.createElement(c.a,{overlay:y.a.createElement(u.a,null,y.a.createElement(u.a.Item,{key:"0",onClick:function(t){sessionStorage.setItem("stepId",0),e.goBack(),e.setState({classBtnContent:t.item.props.children,stepId:0},(function(){e.props.stepCut({stepId:0}),e.setState({stepId:0})}))}},"\u8bfe\u524d\u9884\u4e60"),y.a.createElement(u.a.Item,{key:"1",onClick:function(t){sessionStorage.setItem("stepId",1),e.goBack(),e.setState({classBtnContent:t.item.props.children,stepId:1},(function(){e.props.stepCut({stepId:1}),e.setState({stepId:1})}))}},"\u8bfe\u5802\u6559\u5b66"),y.a.createElement(u.a.Item,{key:"2",onClick:function(t){sessionStorage.setItem("stepId",2),e.goBack(),e.setState({classBtnContent:t.item.props.children,stepId:2},(function(){e.props.stepCut({stepId:2}),e.setState({stepId:2})}))}},"\u8bfe\u540e\u590d\u4e60")),trigger:["click"],placement:"topCenter",className:"class-dropdown"},y.a.createElement(l.a,null,0==sessionStorage.getItem("stepId")?"\u8bfe\u524d\u9884\u4e60":2==sessionStorage.getItem("stepId")?"\u8bfe\u540e\u590d\u4e60":"\u8bfe\u5802\u6559\u5b66",y.a.createElement(E.a,null))),y.a.createElement("p",{onClick:function(){e.finishClass()}},y.a.createElement("i",{className:"iconfont"},"\ue634"),3==r?"\u9000\u51fa":"\u4e0b\u8bfe"),y.a.createElement("p",{onClick:function(){var t={courseId:a,classroomId:n,catalogId:s};sessionStorage.setItem("coursewareBack","success"),sessionStorage.removeItem("prevIds"),e.props.history.replace("/teching/projection-screen/courseware?".concat(encodeURI(JSON.stringify(t))))}},y.a.createElement("i",{className:"iconfont"},"\ue75b"),"\u8bfe\u4ef6"),y.a.createElement("div",{className:"switch",title:"\u6253\u5f00/\u5173\u95ed\u4e92\u52a8\u5217\u8868",onClick:this.rightSwitch.bind(this)},y.a.createElement(w.a,null))):null,y.a.createElement("p",{style:{float:"right"},onClick:function(){window.location.reload(!0)}},y.a.createElement("i",{className:"iconfont"},"\ue6a7"),"\u5237\u65b0"))}}]),a}(v.Component))||n),C=r.a.create()(N);t.a=C},1867:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return s}));a(41),a(8),a(1861),a(1957),a(111);function n(e){var t=parseInt(e),a=0,n=0;t>=60&&(a=parseInt(t/60),t=parseInt(t%60),a>=60&&(n=parseInt(a/60),a=parseInt(a%60))),t<10&&(t="0"+parseInt(t));var s=""+t;return a>=0&&(a<10&&(a="0"+parseInt(a)),s=a+":"+s),n>=0&&(n<10&&(n="0"+parseInt(n)),s=n+":"+s),s}function s(e){if(!e||"string"!=typeof e)return!1;var t=e.split("").reverse().join("");return t.substring(0,t.search(/\./)).split("").reverse().join("")}},2315:function(e,t,a){},2725:function(e,t,a){"use strict";a.r(t);a(43);var n=a(2),s=a.n(n),r=(a(109),a(72)),i=a.n(r),c=a(3),o=a.n(c),l=a(7),d=(a(54),a(15)),u=a.n(d),m=a(9),p=a(12),f=a(11),h=a(10),I=(a(67),a(28)),g=a.n(I),v=a(0),y=a.n(v),S=(a(2315),a(93),a(948),a(209)),E=(a(39),a(181),a(943),a(136),a(243),a(1776)),w=a(1762),k=a(75),b=a(520),N=a.n(b),C=(a(2316),a(111)),O=a(239),x=a(1867),j=a(2791),B=a(2792),T=a(2793),P=a(2794),R=(N()(),g.a.confirm,function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={userId:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).user.id:"",resourceDetail:{},showHead:1,resourceId:"",addResource:"",url:"",hierarchy:"",courseId:"",catalogId:"",classroomId:"",header:"",stepId:sessionStorage.getItem("stepId")?sessionStorage.getItem("stepId"):1,activeKey:"",resUrl:"",backTypeCourse:"",handIsShow:!1,leftStyle:{width:"82%"},visibFlag:0,rightStyle:{width:"18%"},previewSrc:1,imgArr:[],pageIndex:0,total:0},e.controlProgess=function(t){var a=t.body.msg,n=a.type,s=a.position,r=a.voice,i=a.playType;if(0==n){var c=1==s?"next":"prev";e.changePage(c)}else if(1==n){var o=document.querySelector("#previewVideo"),l=o.duration,d=Math.ceil(.05*l);if(o)if(0==i?o.pause():1==i&&o.play(),r>=0&&r<=1&&(o.volume=r,o.muted=0==r),1==s){if(o.currentTime>=l)return void u.a.warning("\u5df2\u7ecf\u6700\u5927\u4e86");o.currentTime+=d}else if(-1==s){if(o.currentTime<=0)return void u.a.warning("\u5df2\u7ecf\u6700\u5c0f\u4e86");o.currentTime-=d}}},e.changePage=function(t){var a=e.state,n=a.iframeSrc,s=a.pageIndex,r=a.resourceDetail,i=a.total,c=r.resourceName;if(-1===C.g.indexOf(Object(x.a)(c)))return!1;if("next"===t){if(s>=i-1)return void u.a.warning("\u5df2\u7ecf\u662f\u6700\u540e\u4e00\u9875\u4e86");s++}else{if(s<=0)return void u.a.warning("\u5df2\u7ecf\u662f\u7b2c\u4e00\u9875\u4e86");s--}document.querySelector("#myIframe").src="".concat(C.b,"sn=").concat(s,"&furl=").concat(C.d,"/api/media/api/v1/media/download/").concat(r.fileId),e.setState({iframeSrc:n,pageIndex:s})},e.getSlidePage=function(){var t=e.state.resourceDetail;Object(O.A)({fileId:t.fileId}).then((function(t){t&&(t=t.slideCount?t.slideCount:t.pageCount?t.pageCount:t.sheetCount?t.sheetCount:1/0,e.setState({total:t}))}))},e.createIframe=function(t){e.setState({visibFlag:1});var a=document.createElement("iframe"),n="".concat(C.b,"sn=").concat(e.state.pageIndex,"&furl=").concat(C.d,"/api/media/api/v1/media/download/").concat(t.fileId);if(e.setState({iframeSrc:n}),a.src=n,a.width="100%",a.height="700px",a.id="myIframe",k.a.isEmpty(a)||k.a.isEmpty(document.getElementById("previewIframe"))||document.getElementById("previewIframe").appendChild(a),t&&t.fileName){var s=t.fileName.split("."),r=s.length-1,i=s&&s.length>0?s[r]:"";-1!==C.h.indexOf(i)?document.getElementById("previewIframe").style.background="#ffffff":"pdf"==i&&(document.getElementById("previewIframe").style.background="#E6E6E6")}},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e,t,a,n,s,r,i,c=this,o=this.props.location.search;if(o&&(a=(e=o.split("?")[1]).includes("%")?decodeURI(e):e,s=(t=JSON.parse(a)).courseId,i=t.classroomId,n=t.catalogId,r=t.id),r)this.setState({showHead:1,resourceId:r,hierarchy:void 0,courseId:s,catalogId:n,addResource:void 0,url:void 0,resUrl:void 0,classroomId:i,activeKey:void 0,header:void 0,handIsShow:void 0,backTypeCourse:""},(function(){c.init()}));else{var l=this.props.location.search,d=(void 0).parse?(void 0).parse(l,!0).query.id:"";this.setState({resourceId:d},(function(){c.init()}))}}},{key:"rightSwitch",value:function(){this.state.switchStatus?this.setState({switchStatus:!1,leftStyle:{width:"100%"},rightStyle:{width:"0",minWidth:"0"}}):this.setState({switchStatus:!0,leftStyle:{width:"82%"},rightStyle:{width:"18%",minWidth:"300px"}})}},{key:"init",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getResource();case 2:this.getFileUrl();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getResource",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.resourceId,e.next=3,Object(S.c)({id:t});case 3:a=e.sent,this.setState({resourceDetail:a},(function(){return n.getSlidePage()}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFileUrl",value:function(){var e=this.state.resourceDetail;if(9===e.mediaType){this.setState({visibFlag:1});var t=document.createElement("iframe"),a={content:e.content,resourceName:e.resourceName};t.src="/#/teching/safety-check?".concat(encodeURI(JSON.stringify(a))),t.parmas=a,document.getElementById("previewIframe").appendChild(t)}else if(1===e.mediaType||8===e.mediaType){var n=e.resourceName;n.includes(".txt")||n.includes(".xlsx")||n.includes(".xls")||n.includes(".rtf")||this.setState({visibFlag:1}),this.createIframe(e)}else if(99===e.mediaType){this.setState({visibFlag:1});var s=document.createElement("iframe"),r={content:e.content,resourceName:e.resourceName};s.src="/#/teching/safety-down?".concat(encodeURI(JSON.stringify(r))),s.parmas=r,document.getElementById("previewIframe").appendChild(s)}}},{key:"render",value:function(){var e=this,t=this.state,n=(t.userId,t.resourceDetail),r=t.rightStyle,c=(t.header,t.leftStyle),o=(t.imgArr,t.previewSrc,t.visibFlag,Object(x.a)(n.resourceName));return y.a.createElement("div",{className:"interaction"},y.a.createElement(s.a,{className:"screen-left preview-box",style:c},y.a.createElement("div",{className:"screen-left-top"},n.title),y.a.createElement("div",{className:"showWrap"},1===n.validFlag?y.a.createElement("div",{className:""},y.a.createElement("div",{className:"preview-wrapper"},5===n.mediaType?y.a.createElement("video",{width:"100%",height:"100%",id:"previewVideo",className:"preview_ideo",controls:"controls",controlsList:"nodownload"},y.a.createElement("source",{src:"".concat(C.f,"/").concat(n.filePath)})):4===n.mediaType?y.a.createElement("div",{className:"audio_content"},y.a.createElement("div",{className:"audio_wrapper"},y.a.createElement("div",null,y.a.createElement("div",null,y.a.createElement("img",{src:a(183),alt:""})),y.a.createElement("div",null,n.resourceName))),y.a.createElement("div",{className:"audio_footer"},y.a.createElement("audio",{id:"previewVideo",controls:"controls",controlsList:"nodownload",className:"preview_audio",volice:"0.5"},y.a.createElement("source",{src:"".concat(C.f,"/").concat(n.filePath)})))):6===n.mediaType?y.a.createElement("embed",{src:"/api/media/api/v1/media/getMedia/".concat(n.fileId)}):3===n.mediaType?y.a.createElement("img",{src:"/api/media/api/v1/media/getMedia/".concat(n.fileId),alt:"",className:"preview_img"}):y.a.createElement("div",{style:{width:"100%",height:"100%"}},y.a.createElement("div",{id:"previewIframe"},"pdf"===o?y.a.createElement("div",{className:"none-scroll"}):null,"pdf"===o?y.a.createElement("div",{onClick:function(){return e.changePage("next")},className:"next-pdf-btn"},y.a.createElement(j.a,null)):null,"pdf"===o?y.a.createElement("div",{onClick:function(){return e.changePage("prev")},className:"prev-pdf-btn"},y.a.createElement(B.a,null)):null,"pptx"===o||"ppt"===o?y.a.createElement("div",{title:"\u4e0a\u4e00\u9875",onClick:function(){return e.changePage("prev")},className:"prev-btn"},y.a.createElement(T.a,null)):null,"pptx"===o||"ppt"===o?y.a.createElement("div",{title:"\u4e0b\u4e00\u9875",onClick:function(){return e.changePage("next")},className:"next-btn"},y.a.createElement(P.a,null)):null))," ")):y.a.createElement(i.a,{description:"\u8d44\u6e90\u5df2\u5220\u9664",image:i.a.PRESENTED_IMAGE_SIMPLE})),y.a.createElement("div",{className:"screen-left-bottom"},y.a.createElement(w.a,{refresh:function(){window.location.reload(!0)},goBackVis:this.state.goBackisShow,open:this.rightSwitch.bind(this),stepCut:function(t){e.setState({stepId:t.stepId})}}))),y.a.createElement(s.a,{className:"interaction-right",style:r},y.a.createElement(E.a,{controlProgess:this.controlProgess,parentPlay:this.parentPlay,stepId:this.state.stepId})))}}]),n}(v.Component));t.default=R}}]);