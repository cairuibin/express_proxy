(this.webpackJsonpzjyz_admin=this.webpackJsonpzjyz_admin||[]).push([[118],{1979:function(e,a,t){"use strict";t.d(a,"b",(function(){return s})),t.d(a,"a",(function(){return i})),t.d(a,"d",(function(){return l})),t.d(a,"c",(function(){return r})),t.d(a,"e",(function(){return c}));var n=t(4);function s(e){return Object(n.d)("/api/interaction/api/v1/live/liveRoom/getTeacherLiveRoomList",e)}function i(e){return Object(n.d)("/api/interaction/api/v1/live/liveRoom/addLiveTask",e)}function l(e){return Object(n.d)("/api/interaction/api/v1/live/liveRoom/updateLiveTask",e)}function r(e){return Object(n.c)("/api/interaction/api/v1/live/liveRoom/getVideoList",e)}function c(e){return Object(n.c)("/api/interaction/api/v1/live/liveRoom/webVerificationLive",e)}},2076:function(e,a,t){"use strict";t.r(a);t(109);var n=t(72),s=t.n(n),i=(t(155),t(53)),l=t.n(i),r=(t(278),t(156)),c=t.n(r),o=(t(382),t(168)),m=t.n(o),u=(t(40),t(5)),d=t.n(u),p=(t(43),t(2)),v=t.n(p),f=t(3),h=t.n(f),g=t(7),k=t(98),E=(t(54),t(15)),S=t.n(E),b=t(144),N=t(9),y=t(12),C=t(11),L=t(10),T=(t(51),t(22)),w=t.n(T),j=(t(41),t(8)),O=t.n(j),D=t(0),I=t.n(D),V=t(2009),x=t(1911),M=(t(1875),t(27)),Y=t(36),R=t.n(Y),H=["Apple","Orange"],A=O.a.Item,z=w.a.TextArea;function B(e,a){var t=new FileReader;t.addEventListener("load",(function(){return a(t.result)})),t.readAsDataURL(e)}var P=function(e){Object(C.a)(t,e);var a=Object(L.a)(t);function t(){var e;Object(N.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={open:!1,checkedList:H,indeterminate:!0,checkAll:!1,taskName:"",taskStartTime:"",applicationType:"",taskEndTime:void 0,taskExplain:"",myStageList:[],myStageTo:"",id:"",loading:!1,fileList:[],acceptType:".jpeg,.png,.gif,.jpg",liveDetail:{},fileId:"",ids:[],disableId:[],playbackSupported:1,imageUrl:e.props.liveDetail.livePic?"/api/media/api/v1/media/showThumbnail/"+e.props.liveDetail.livePic:null,inval:"",invalNum:""},e.onSubjectChange=function(a){var t=e.state.myStageList;e.setState({ids:a,indeterminate:!!a.length&&a.length<t.length,checkAll:a.length===t.length})},e.onCheckAllChange=function(a){var t=e.state.myStageList.map((function(e){return e.id}));e.setState({ids:a.target.checked?t:[],indeterminate:!1,checkAll:a.target.checked})},e.getItemsValue=function(){var a=e.props.form.getFieldsValue();return a.ids=e.state.ids.join(","),a.taskStatus=e.state.taskStatus,a.liveId=e.state.id,a},e.disabledStartDate=function(a){var t=(new Date).getTime()-864e5,n=e.state.taskEndTime;return a.valueOf()<t?a.valueOf()<t:!(!a||!n)&&a.valueOf()>n.valueOf()},e.disabledEndDate=function(a){var t=(new Date).getTime()-864e5,n=e.state.startValue;return a.valueOf()<t?a.valueOf()<t:!(!a||!n)&&a.valueOf()<=n.valueOf()},e.onStartChange=function(a){e.onChange("startValue",a)},e.onEndChange=function(a){e.onChange("endValue",a)},e.onChange=function(a,t){e.setState(Object(b.a)({},a,t))},e.beforefn=function(a){var t=e.state.acceptType.split(","),n=a.file.name,s=n.substring(n.lastIndexOf("."),n.length);if(t.includes(s)){if(!(a.file.size/1024/1024<5))return S.a.error("\u6587\u4ef6\u4e0d\u80fd\u5927\u4e8e5M"),!1;e.setState({loading:!0}),e.fileChange(a)}else S.a.error("\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u683c\u5f0f")},e.uploadRemove=function(a){e.state.fileTitle="",e.setState({result:{},fileId:void 0})},e.fileChange=function(a){if(a){var t=Object(k.a)(a.fileList);if(t=(t=t.slice(-1)).map((function(e){return e.response&&(e.url=e.response.url),e})),e.setState({fileList:t}),"done"===a.file.status)if(B(a.file.originFileObj,(function(a){return e.setState({imageUrl:a,loading:!1})})),0===a.file.response.code){var n=a.file.response.result;e.setState({result:n,fileId:n.id,fileTitle:""}),S.a.success("".concat(a.file.name," \u4e0a\u4f20\u6210\u529f"))}else e.setState({result:{},fileList:[],fileId:void 0,fileTitle:""}),S.a.error(a.file.response.message);else"error"===a.file.status&&(e.setState({result:{},fileList:[],fileId:void 0}),e.props.form.setFieldsValue({fileObj:void 0}),S.a.error("".concat(a.file.name," \u4e0a\u4f20\u5931\u8d25")))}},e.changeChat=function(a){e.setState({inval:a.target.value})},e.changeChat2=function(a){e.setState({invalNum:a.target.value})},e}return Object(y.a)(t,[{key:"componentWillMount",value:function(){var e=this,a=this.props.liveDetail;this.setState({taskName:a.taskName,taskStartTime:a.taskStartTime,taskEndTime:a.taskEndTime,id:a.id,fileId:a.livePic,taskExplain:a.taskExplain,disableId:a.subjectList,taskStatus:a.taskStatus,playbackSupported:a.playbackSupported,inval:a.taskName,invalNum:a.taskExplain}),a.subjectList.map((function(a,t){e.state.ids.push(a.subjectId)}))}},{key:"componentDidMount",value:function(){this.getSubjectByLogin()}},{key:"getSubjectByLogin",value:function(){var e=Object(g.a)(h.a.mark((function e(a){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(M.x)({});case 2:t=e.sent,this.setState({myStageTo:t[0].id,myStageList:t});case 4:case"end":return e.stop()}}),e,this)})));return function(a){return e.apply(this,arguments)}}()},{key:"disabledDate",value:function(e){return e<R()().subtract(1,"day")}},{key:"render",value:function(){var e,a=this,t={labelCol:{span:5},wrapperCol:{span:19}},n=I.a.createElement("div",null,this.state.loading?I.a.createElement(V.a,null):I.a.createElement(x.a,null),I.a.createElement("div",{className:"ant-upload-text"},"\u56fe\u7247")),i=this.state,r=i.myStageList,o=i.taskName,u=i.taskExplain,p=i.taskEndTime,f=i.taskStartTime,h=(i.id,i.imageUrl),g=i.fileId,k=i.fileList,E=i.ids,S={action:"/api/media/api/v1/media/addMedia",onChange:this.beforefn,onRemove:this.uploadRemove},N=this.props.form.getFieldDecorator;return I.a.createElement(O.a,{className:"live-form",layout:"horizontal",style:{paddingBottom:18}},I.a.createElement(d.a,{className:"live-row"},I.a.createElement(v.a,{span:5},I.a.createElement("span",{className:"create-course-title "},I.a.createElement("span",{className:"red"},"*"),"\u76f4\u64ad\u4efb\u52a1\u540d\u79f0\uff1a")),I.a.createElement(v.a,{span:19,className:"formItem-sty"},I.a.createElement(A,t,N("taskName",{initialValue:o,rules:[{required:!0,message:"\u76f4\u64ad\u4efb\u52a1\u540d\u79f0\u4e3a\u7a7a"}]})(I.a.createElement(w.a,(e={className:"input-text",maxLength:15},Object(b.a)(e,"maxLength",15),Object(b.a)(e,"value",this.state.inval),Object(b.a)(e,"onChange",(function(e){return a.changeChat(e)})),e))),I.a.createElement("span",{style:{position:"absolute",bottom:"-13px",right:"10px",userSelect:"none"}},this.state.inval.length,"/15")))),I.a.createElement(d.a,{className:"live-row"},I.a.createElement(v.a,{span:5},I.a.createElement("span",{className:"create-course-title "},I.a.createElement("span",{className:"red"},"*"),"\u76f4\u64ad\u5f00\u59cb\u65f6\u95f4\uff1a")),I.a.createElement(v.a,{span:19,className:"time-wap"},I.a.createElement(A,null,N("taskStartTime",{initialValue:f?R()(f||"YYYY-MM-DD HH:mm:ss"):void 0,rules:[{required:!0,message:"\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a!"}]})(I.a.createElement(m.a,{disabledDate:this.disabledStartDate,onChange:this.onStartChange,showTime:!0}))))),I.a.createElement(d.a,{className:"live-row"},I.a.createElement(v.a,{span:5},I.a.createElement("span",{className:"create-course-title "},I.a.createElement("span",{className:"red"},"*"),"\u76f4\u64ad\u7ed3\u675f\u65f6\u95f4\uff1a")),I.a.createElement(v.a,{span:19,className:"time-wap"},I.a.createElement(A,null,N("taskEndTime",{initialValue:p?R()(p||"YYYY-MM-DD HH:mm:ss"):void 0,rules:[{required:!0,message:"\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a!"}]})(I.a.createElement(m.a,{format:"YYYY-MM-DD HH:mm:ss",disabledDate:this.disabledEndDate,onChange:this.onEndChange,showTime:!0}))))),I.a.createElement(d.a,{className:"live-row"},I.a.createElement(v.a,{span:5},I.a.createElement("span",{className:"create-course-title "},I.a.createElement("span",{className:"red"},"*"),"\u4efb\u52a1\u5c01\u9762\uff1a")),I.a.createElement(v.a,{span:5},I.a.createElement(A,{className:"upload-lu"},N("fileId",{initialValue:g,rules:[{required:!0,message:"\u4efb\u52a1\u5c01\u9762\u4e0d\u80fd\u4e3a\u7a7a!"}]})(I.a.createElement(c.a,Object.assign({showUploadList:!1,name:"file",listType:"picture-card",className:"avatar-uploader"},S,{fileList:k}),h?I.a.createElement("img",{src:h,alt:"avatar",style:{width:"100%"}}):n)))),I.a.createElement(v.a,{span:11,className:"suggest-l"},I.a.createElement("p",null,"\u652f\u6301jpg/gif/png/jpeg\u683c\u5f0f\uff0c"),I.a.createElement("p",null,"\u5efa\u8bae\u6700\u4f73\u5c3a\u5bf8750X422px\uff0c\u4e0d\u8d85\u8fc75M"))),I.a.createElement(d.a,{className:"live-row"},I.a.createElement(v.a,{span:5},I.a.createElement("span",{className:"create-course-title "},"\u76f4\u64ad\u8bf4\u660e\uff1a ")),I.a.createElement(v.a,{span:19,className:"text-wap"},I.a.createElement(A,Object.assign({},t,{className:"FormItem-textarea"}),N("taskExplain",{initialValue:u})(I.a.createElement(z,{className:"textarea-text",style:{resize:"none"},rows:4,maxLength:100,value:this.state.invalNum,onChange:function(e){return a.changeChat2(e)}})),I.a.createElement("span",{style:{position:"absolute",bottom:"-3px",right:"10px",userSelect:"none"}},this.state.invalNum?this.state.invalNum.length:0,"/100")))),I.a.createElement(d.a,{className:"live-row live-active"},I.a.createElement(v.a,{span:5},I.a.createElement("span",{className:"create-course-title "},I.a.createElement("span",{className:"red"},"*"),"\u76f4\u64ad\u8303\u56f4\uff1a ")),I.a.createElement(v.a,{span:24},I.a.createElement("div",{className:"conet"},I.a.createElement(A,t,I.a.createElement("div",{className:"site-checkbox-all-wrapper"},I.a.createElement(l.a,{indeterminate:this.state.indeterminate,onChange:this.onCheckAllChange,checked:this.state.checkAll},"\u5168\u9009\uff08\u9009\u62e9\u540e\u53ea\u6709\u8be5\u8bfe\u7a0b\u4e0b\u7684\u5b66\u5458\u624d\u80fd\u8fdb\u5165\u76f4\u64ad\uff09")),I.a.createElement("div",{className:"site-wap"},I.a.createElement(l.a.Group,{onChange:this.onSubjectChange,value:E},r&&r.length>0?r.map((function(e,a){return I.a.createElement(l.a,{value:e.id,title:e.subjectName,key:e.id,checked:"true"},e.subjectName)})):I.a.createElement(s.a,null))))))))}}]),t}(D.Component),F=O.a.create()(P);a.default=F},2736:function(e,a,t){"use strict";t.r(a);t(41);var n=t(8),s=t.n(n),i=(t(109),t(72)),l=t.n(i),r=(t(177),t(110)),c=t.n(r),o=(t(379),t(179)),m=t.n(o),u=(t(97),t(14)),d=t.n(u),p=(t(40),t(5)),v=t.n(p),f=(t(45),t(6)),h=t.n(f),g=(t(43),t(2)),k=t.n(g),E=(t(67),t(28)),S=t.n(E),b=t(3),N=t.n(b),y=t(7),C=(t(54),t(15)),L=t.n(C),T=t(9),w=t(12),j=t(52),O=t(11),D=t(10),I=(t(51),t(22)),V=t.n(I),x=t(0),M=t.n(x),Y=(t(1875),t(93)),R=t(2328),H=t(2076),A=t(1979),z=t(27),B=t(36),P=t.n(B),F=V.a.Search;var U=function(e){Object(O.a)(t,e);var a=Object(D.a)(t);function t(){var e;Object(T.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={randomkey:e.randomkey(),visible:!1,confirmLoading:!1,total:0,pageNum:1,pageSize:12,teacherLiveRoomList:[],taskName:"",taskStatus:"",myStageList:[],myStageTo:"",modal1Visible:!1,modal2Visible:!1,modal3Visible:!1,value:1,updateLiveTask:[],liveDetail:{},userId:"",humanName:"",playbackSupported:"",isView:"",id:"",isClick:!0},e.getTaskStatusChange=function(a){e.setState({pageNum:1,taskStatus:a.target.value},(function(){e.getTeacherLiveRoomList()}))},e.searchChangeSchool=function(a){e.setState({pageNum:1,taskName:a.target.value},(function(){e.getTeacherLiveRoomList()}))},e.addCancel=function(){e.setState({modal1Visible:!1,modal3Visible:!1})},e.updateCancel=function(){e.setState({modal1Visible:!1,modal3Visible:!1})},e.regionChange=function(a){e.setState({myStageTo:a.target.value},(function(){e.getTeacherLiveRoomList()}))},e.onShowSizeChange=function(a,t){e.setState({pageNum:1,pageSize:t},(function(){e.getTeacherLiveRoomList()}))},e.onPageNumChange=function(a,t){e.setState({pageNum:a},(function(){e.getTeacherLiveRoomList()}))},e.handCreateLive=function(){if(e.state.isClick){var a=e.LiveForms.getItemsValue(),t={teacherId:e.state.userId,teacherName:e.state.humanName,taskStatus:0,subjectIds:a.id,taskName:a.taskName,initiator:"WEB",taskStartTime:P()(a.taskStartTime).format("YYYY-MM-DD HH:mm:ss"),taskEndTime:P()(a.taskEndTime).format("YYYY-MM-DD HH:mm:ss"),taskExplain:a.taskExplain,playbackSupported:a.playbackSupported};a.fileId&&a.fileId.file&&a.fileId.file.response&&a.fileId.file.response.result.id&&(t.livePic=a.fileId.file.response.result.id);var n=(new Date).getTime(),s=P()(a.taskStartTime).format("YYYY-MM-DD HH:mm:ss"),i=P()(a.taskEndTime).format("YYYY-MM-DD HH:mm:ss"),l=new Date(i)-new Date(s);if(""===a.taskName)return L.a.error("\u76f4\u64ad\u4efb\u52a1\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a");if(new Date(s)>new Date(i))return L.a.error("\u76f4\u64ad\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65f6\u95f4");if(l>72e5)return L.a.error("\u76f4\u64ad\u7ed3\u675f\u65f6\u95f4\u8ddd\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u4e24\u5c0f\u65f6");if(n>new Date(i).getTime())return L.a.error("\u76f4\u64ad\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f53\u524d\u65f6\u95f4");if(a.id===[]||void 0===a.id||null===a.id||""===a.id)return L.a.error("\u81f3\u5c11\u5173\u8054\u4e00\u4e2a\u8bfe\u5802");Object(A.a)(t).then((function(a){L.a.success("\u6dfb\u52a0\u6210\u529f"),e.setState({modal1Visible:!1,modal3Visible:!1,confirmLoading:!0}),e.getTeacherLiveRoomList()})),e.setState({isClick:!1});var r=Object(j.a)(e);setTimeout((function(){r.setState({isClick:!0})}),3e3)}},e.updateLive=function(){var a=e.LiveFormeditors.getItemsValue(),t={id:a.liveId,teacherId:e.state.userId,teacherName:e.state.humanName,taskStatus:a.taskStatus,subjectIds:a.ids,taskName:a.taskName,taskStartTime:P()(a.taskStartTime).format("YYYY-MM-DD HH:mm:ss"),taskEndTime:P()(a.taskEndTime).format("YYYY-MM-DD HH:mm:ss"),taskExplain:a.taskExplain,playbackSupported:a.playbackSupported};a.fileId.file&&a.fileId.file.response&&a.fileId.file.response.result.id&&(t.livePic=a.fileId.file.response.result.id);var n=(new Date).getTime(),s=P()(a.taskStartTime).format("YYYY-MM-DD HH:mm:ss"),i=P()(a.taskEndTime).format("YYYY-MM-DD HH:mm:ss"),l=new Date(i)-new Date(s);return""===a.taskName?L.a.error("\u76f4\u64ad\u4efb\u52a1\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"):new Date(s)>new Date(i)?L.a.error("\u76f4\u64ad\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f00\u59cb\u65f6\u95f4"):l>72e5?L.a.error("\u76f4\u64ad\u7ed3\u675f\u65f6\u95f4\u8ddd\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u4e24\u5c0f\u65f6"):n>new Date(i).getTime()?L.a.error("\u76f4\u64ad\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u5c0f\u4e8e\u5f53\u524d\u65f6\u95f4"):a.ids===[]||void 0===a.ids||null===a.ids||""===a.ids?L.a.error("\u81f3\u5c11\u5173\u8054\u4e00\u4e2a\u8bfe\u5802"):void Object(A.d)(t).then((function(a){L.a.success("\u4fee\u6539\u6210\u529f"),e.setState({modal1Visible:!1,modal3Visible:!1,confirmLoading:!0}),e.getTeacherLiveRoomList()}))},e.updateLiveSupported=function(){var a={id:e.state.id,isView:e.state.isView};Object(A.d)(a).then((function(a){e.setState({modal2Visible:!1}),e.getTeacherLiveRoomList()}))},e.setModal3Visible=function(a){(new Date).getTime()>new Date(a.taskStartTime)&&2===a.taskStatus?L.a.error("\u5f00\u59cb\u65f6\u95f4\u5df2\u8fc7\u671f\uff0c\u4e0d\u80fd\u7f16\u8f91"):e.setState({liveDetail:a,modal3Visible:!0})},e.setModal2Visible=function(a){e.setState({modal2Visible:!0,isView:a.isView,id:a.id})},e.cancelModal2Visible=function(){e.setState({modal2Visible:!1})},e.onChange=function(a){e.setState({isView:a.target.value})},e.seeLive=function(){var a=Object(y.a)(N.a.mark((function a(t){return N.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:Object(A.e)({liveTaskId:t.id}).then((function(a){return 5===a.result.taskStatus?L.a.error("\u76f4\u64ad\u4efb\u52a1\u5df2\u8fc7\u671f\uff0c\u4e0d\u80fd\u8fdb\u5165"):6===a.result.taskStatus?L.a.error("\u76f4\u64ad\u4efb\u52a1\u5df2\u7ed3\u675f\uff0c\u4e0d\u80fd\u8fdb\u5165"):0===a.result.taskStatus?L.a.error("\u76f4\u64ad\u4efb\u52a1\u672a\u53d1\u5e03\uff0c\u4e0d\u80fd\u8fdb\u5165"):void Object(A.d)({id:t.id,taskStatus:3}).then((function(a){if(-1!==a.code){var n={roomId:t.roomId,liveTaskId:t.id,taskName:t.taskName};e.props.history.push("/teching/my-live/live-pageshow?".concat(encodeURI(JSON.stringify(n))))}}))}));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.seeContinueLive=function(){var a=Object(y.a)(N.a.mark((function a(t){return N.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:Object(A.e)({liveTaskId:t.id}).then((function(a){if(5===a.result.taskStatus)return L.a.error("\u76f4\u64ad\u4efb\u52a1\u5df2\u8fc7\u671f\uff0c\u4e0d\u80fd\u8fdb\u5165");if(6===a.result.taskStatus)return L.a.error("\u76f4\u64ad\u4efb\u52a1\u5df2\u7ed3\u675f\uff0c\u4e0d\u80fd\u8fdb\u5165");if(0===a.result.taskStatus)return L.a.error("\u76f4\u64ad\u4efb\u52a1\u672a\u53d1\u5e03\uff0c\u4e0d\u80fd\u8fdb\u5165");if("APP"===a.result.initiator)return L.a.error("\u76f4\u64ad\u4efb\u52a1\u5df2\u5728APP\u7aef\u5f00\u59cb\uff0c\u4e0d\u80fd\u5207\u6362\u8bbe\u5907\u7ee7\u7eed\u76f4\u64ad");var n={roomId:t.roomId,liveTaskId:t.id,taskName:t.taskName};e.props.history.push("/teching/my-live/live-pageshow?".concat(encodeURI(JSON.stringify(n))))}));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.seeMyLiveList=function(){var a=Object(y.a)(N.a.mark((function a(t){var n;return N.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n={liveTaskId:t.id,taskName:t.taskName},e.props.history.push("/teching/my-live/live-list?".concat(encodeURI(JSON.stringify(n))));case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e}return Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")):"";this.setState({humanName:e.user.humanName,userId:e.user.id}),this.getSubjectByLogin(),this.getTeacherLiveRoomList()}},{key:"getSubjectByLogin",value:function(){var e=Object(y.a)(N.a.mark((function e(a){var t,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(z.x)({});case 2:t=e.sent,n=[{subjectName:"\u5168\u90e8",id:""}].concat(t),this.setState({myStageTo:n[0].id,myStageList:n}),this.getTeacherLiveRoomList();case 7:case"end":return e.stop()}}),e,this)})));return function(a){return e.apply(this,arguments)}}()},{key:"getTeacherLiveRoomList",value:function(){var e=Object(y.a)(N.a.mark((function e(){var a,t,n,s,i,l,r,c,o;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state,t=a.pageNum,n=a.pageSize,s=a.taskName,i=a.taskStatus,l=a.myStageTo,r=a.userId,c={pageNum:t,pageSize:n,teacherId:r,taskName:s,liveStatus:i,subjectId:l},e.next=4,Object(A.b)(c);case 4:o=e.sent,this.setState({teacherLiveRoomList:o?o.data:null,total:o?o.total:0});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delAnnouncement",value:function(e){var a=this;S.a.confirm({title:"\u63d0\u793a",content:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff01",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",className:"ModalConfirm",onOk:function(){Object(A.d)({id:e,idDelete:1}).then((function(e){L.a.success("\u5220\u9664\u6210\u529f"),a.getTeacherLiveRoomList()}))},onCancel:function(){}})}},{key:"deleteLive",value:function(e){var a=this;S.a.confirm({title:"\u63d0\u793a",content:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f\u76f4\u64ad\u56de\u653e\u4f1a\u88ab\u4e00\u8d77\u5220\u9664\u3002\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff01",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",className:"ModalConfirm",onOk:function(){Object(A.d)({id:e,idDelete:1}).then((function(e){L.a.success("\u5220\u9664\u6210\u529f"),a.getTeacherLiveRoomList()}))},onCancel:function(){}})}},{key:"randomkey",value:function(){return(Math.random(1e5)+"").replace(/^0\./,"")}},{key:"setModal1Visible",value:function(e){this.setState({modal1Visible:e})}},{key:"toRelease",value:function(e){var a=this;if(0===e.taskStatus){(new Date).getTime(),new Date(e.taskStartTime);Object(A.d)({taskStatus:1,id:e.id,taskStartTime:e.taskStartTime,taskEndTime:e.taskEndTime,teacherId:e.teacherId}).then((function(e){L.a.success("\u53d1\u5e03\u6210\u529f"),a.getTeacherLiveRoomList()}))}else{(new Date).getTime()>new Date(e.taskStartTime)?L.a.error("\u5f00\u59cb\u65f6\u95f4\u5df2\u8fc7\u671f\uff0c\u4e0d\u80fd\u53d6\u6d88\u53d1\u5e03"):Object(A.d)({taskStatus:0,id:e.id}).then((function(e){L.a.success("\u53d6\u6d88\u53d1\u5e03\u6210\u529f"),a.getTeacherLiveRoomList()}))}}},{key:"render",value:function(){var e=this,a=this.state,t=(a.visible,a.confirmLoading),n=(a.ModalText,a.pageNum),s=a.pageSize,i=a.total,r=a.teacherLiveRoomList,o=a.myStageList,u=a.myStageTo,p=r.map((function(a,t){return M.a.createElement(v.a,{className:"mylive-list",key:t},M.a.createElement(k.a,{span:18},M.a.createElement("div",{className:"pic-img"},M.a.createElement("img",{src:"/api/media/api/v1/media/showImage/".concat(a.livePic),alt:""})),M.a.createElement("div",{className:"left"},M.a.createElement("div",{className:"title"},M.a.createElement("h2",{title:""},a.taskName),0==a.taskStatus?M.a.createElement("span",{className:"span"},"\u672a\u53d1\u5e03"):2==a.taskStatus?M.a.createElement("span",{className:"span"},"\u672a\u5f00\u59cb"):3==a.taskStatus?M.a.createElement("span",{className:"span"},"\u5df2\u5f00\u59cb"):4==a.taskStatus?M.a.createElement("span",{className:"span"},"\u76f4\u64ad\u4e2d"):5==a.taskStatus?M.a.createElement("span",{className:"span"},"\u5df2\u8fc7\u671f"):6==a.taskStatus?M.a.createElement("span",{className:"span"},"\u5df2\u7ed3\u675f"):""),M.a.createElement("p",null,M.a.createElement("span",null,"\u5f00\u59cb\u65f6\u95f4\uff1a",a.taskStartTime),M.a.createElement("span",null,"\u7ed3\u675f\u65f6\u95f4\uff1a",a.taskEndTime),M.a.createElement("span",null,"\u76f4\u64ad\u8bf4\u660e:",a.taskExplain?a.taskExplain:"\u6682\u65e0")))),0==a.taskStatus?M.a.createElement(k.a,{span:6},M.a.createElement(h.a,{className:"release-live",onClick:function(){return e.toRelease(a)}},"\u53d1\u5e03"),M.a.createElement(h.a,{className:"release-live",onClick:function(){return e.setModal3Visible(a)}},"\u7f16\u8f91"),M.a.createElement(h.a,{className:"release-live",onClick:e.delAnnouncement.bind(e,a.id)},"\u5220\u9664")):2===a.taskStatus||1===a.taskStatus||3===a.taskStatus?M.a.createElement(k.a,{span:6},M.a.createElement(h.a,{className:"release-live",onClick:function(){return e.seeLive(a)}},"\u8fdb\u5165"),M.a.createElement(h.a,{className:"release-live",onClick:e.delAnnouncement.bind(e,a.id)},"\u5220\u9664")):4===a.taskStatus?M.a.createElement(k.a,{span:6},M.a.createElement(h.a,{className:"release-live",onClick:function(){return e.seeContinueLive(a)}},"\u7ee7\u7eed\u76f4\u64ad")):5===a.taskStatus?M.a.createElement(k.a,{span:6},M.a.createElement(h.a,{className:"release-live",onClick:e.delAnnouncement.bind(e,a.id)},"\u5220\u9664")):6===a.taskStatus&&0===a.transcodingStatus&&1===a.playbackSupported?M.a.createElement(k.a,{span:6},M.a.createElement(h.a,{className:"release-live"},"\u8f6c\u7801\u4e2d")):6===a.taskStatus&&1===a.transcodingStatus?M.a.createElement(k.a,{span:6},M.a.createElement(h.a,{className:"release-live",onClick:e.deleteLive.bind(e,a.id)},"\u5220\u9664"),M.a.createElement(h.a,{className:"release-live",onClick:function(){return e.setModal2Visible(a)}},"\u8bbe\u7f6e"),M.a.createElement(h.a,{className:"release-live",onClick:function(){return e.seeMyLiveList(a)}},"\u67e5\u770b")):6===a.taskStatus?M.a.createElement(k.a,{span:6},M.a.createElement(h.a,{className:"release-live",onClick:e.delAnnouncement.bind(e,a.id)},"\u5220\u9664")):"")}));return M.a.createElement("div",{className:"teching-mylive"},M.a.createElement(Y.a,{navName:"my-live"}),M.a.createElement("div",{className:"teching-mylive-pic"},M.a.createElement(v.a,{className:"complete-title"},M.a.createElement(k.a,{span:22},M.a.createElement("span",null,"\u6211\u7684\u76f4\u64ad"))),M.a.createElement("div",{className:"teching-mylive-main"},M.a.createElement(v.a,{className:"paper-common"},M.a.createElement(k.a,{span:1,className:"paper-year"},"\u8bfe\u7a0b"),M.a.createElement(k.a,{span:20},M.a.createElement(d.a.Group,{onChange:this.regionChange.bind(this),value:u},o.length&&o.map((function(e,a){return M.a.createElement(d.a.Button,{key:a,value:e.id},e.subjectName)}))))),M.a.createElement(v.a,{className:"paper-common"},M.a.createElement(k.a,{span:1,className:"paper-year"},"\u72b6\u6001"),M.a.createElement(k.a,{span:20},M.a.createElement(d.a.Group,{onChange:this.getTaskStatusChange.bind(this),defaultValue:""},M.a.createElement(d.a.Button,{value:""},"\u5168\u90e8"),M.a.createElement(d.a.Button,{value:"0"},"\u672a\u53d1\u5e03"),M.a.createElement(d.a.Button,{value:"2"},"\u672a\u5f00\u59cb"),M.a.createElement(d.a.Button,{value:"3"},"\u5df2\u5f00\u59cb"),M.a.createElement(d.a.Button,{value:"4"},"\u76f4\u64ad\u4e2d"),M.a.createElement(d.a.Button,{value:"5"},"\u5df2\u8fc7\u671f"),M.a.createElement(d.a.Button,{value:"6"},"\u5df2\u7ed3\u675f"))))),M.a.createElement("div",{className:"teching-mylive-content"},M.a.createElement(v.a,null,M.a.createElement(k.a,{span:12},M.a.createElement("span",{className:"span"},"\u6d4f\u89c8\u5668\u652f\u6301\uff1aChrome 52+\u3001 QQ\u6d4f\u89c8\u5668 10.2+ \u3001 360\u5b89\u5168\u6d4f\u89c8\u566812+\u3001 360\u6781\u901f\u6d4f\u89c8\u566812+")),M.a.createElement(k.a,{span:12,className:"live-right"},M.a.createElement(F,{placeholder:"\u8bf7\u8f93\u5165\u76f4\u64ad\u540d\u79f0",style:{width:217},onChange:this.searchChangeSchool}),M.a.createElement(h.a,{onClick:function(){return e.setModal1Visible(!0)},className:"new-set-course"},"\u65b0\u5efa\u76f4\u64ad"),M.a.createElement(S.a,{wrapClassName:"live-broadcast",className:"modal-btn-add",title:"\u65b0\u5efa\u76f4\u64ad",visible:this.state.modal1Visible,onOk:function(){return e.setModal1Visible(!1)},onCancel:function(){return e.setModal1Visible(!1)},confirmLoading:t,maskClosable:!1,destroyOnClose:!0,footer:[M.a.createElement("div",{className:"pos-btn",key:this.state.randomkey},M.a.createElement(m.a,{onClick:this.addCancel},"\u53d6\u6d88"),M.a.createElement(m.a,{onClick:this.handCreateLive},"\u4fdd\u5b58"))]},M.a.createElement(R.default,{wrappedComponentRef:function(a){e.LiveForms=a}}))))),M.a.createElement("div",{className:"teching-mylive-bottom"},r&&r.length>0?M.a.createElement("div",null,p||"",M.a.createElement(k.a,{span:24,style:{textAlign:"right",marginTop:10,justifyContent:"flex-end"}},M.a.createElement(c.a,{showSizeChanger:!0,pageSizeOptions:["12","24","36","48"],onShowSizeChange:this.onShowSizeChange,onChange:this.onPageNumChange,defaultCurrent:1,current:n,pageSize:s,total:i,showTotal:function(e){return"\u5171 "+e+" \u6761"}}))):M.a.createElement(l.a,null))),M.a.createElement(S.a,{title:"\u8bbe\u7f6e\u56de\u653e",wrapClassName:"live-setup",className:"modal-setup",maskClosable:!1,visible:this.state.modal2Visible,onOk:this.updateLiveSupported,onCancel:this.cancelModal2Visible,okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88"},M.a.createElement("div",null,M.a.createElement(d.a.Group,{onChange:this.onChange,value:this.state.isView},M.a.createElement(v.a,null,M.a.createElement(k.a,{span:24,className:"col"},M.a.createElement(d.a,{value:1},"\u5141\u8bb8\u5b66\u751f\u70b9\u64ad\u3000"),M.a.createElement("span",{className:"text"},"\uff08\u9009\u62e9\u540e\u6240\u5728\u8bfe\u7a0b\u4e0b\u7684\u5b66\u751f\u53ef\u4ee5\u67e5\u770b\u56de\u653e\uff09")),M.a.createElement(k.a,{span:24,className:"col"},M.a.createElement(d.a,{value:0},"\u4e0d\u5141\u8bb8\u5b66\u751f\u70b9\u64ad"),M.a.createElement("span",{className:"text"},"\uff08\u9009\u62e9\u540e\u6240\u5728\u8bfe\u7a0b\u4e0b\u7684\u5b66\u751f\u53ef\u4ee5\u67e5\u770b\u56de\u653e\uff09")))))),M.a.createElement(S.a,{wrapClassName:"live-broadcast",className:"modal-btn-add",title:"\u7f16\u8f91",visible:this.state.modal3Visible,onOk:function(){return e.setModal3Visible(!1)},onCancel:function(){return e.updateCancel()},confirmLoading:t,maskClosable:!1,destroyOnClose:!0,footer:[M.a.createElement("div",{className:"pos-btn",key:this.state.randomkey},M.a.createElement(m.a,{onClick:this.updateCancel},"\u53d6\u6d88"),M.a.createElement(m.a,{onClick:this.updateLive},"\u4fdd\u5b58"))]},M.a.createElement(H.default,{liveDetail:this.state.liveDetail,wrappedComponentRef:function(a){e.LiveFormeditors=a}})))}}]),t}(x.Component),J=s.a.create()(U);a.default=J}}]);