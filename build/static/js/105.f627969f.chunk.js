(this.webpackJsonpzjyz_admin=this.webpackJsonpzjyz_admin||[]).push([[105],{1766:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return d})),n.d(t,"l",(function(){return f})),n.d(t,"g",(function(){return h})),n.d(t,"a",(function(){return g}));var s=n(4);function a(e){return Object(s.d)("/api/course/api/v1/web/studentHomework/getMyHomeworkList",e)}function r(e){return Object(s.c)("/api/course/api/v1/web/studentHomework/getMyCourseAndYearList",e)}function o(e){return Object(s.c)("/api/course/api/v1/web/studentHomework/getExamInfo",e)}function i(e){return Object(s.c)("/api/course/api/v1/web/studentHomework/getHomeworkDetail",e)}function c(e){return Object(s.d)("/api/course/api/v1/web/studentHomework/submitOneQuestion",e)}function l(e){return Object(s.c)("/api/course/api/v1/web/studentHomework/studentCheckFree",e)}function u(e){return Object(s.c)("/api/course/api/v1/web/studentHomework/studentSubmitHomework",e)}function m(e){return Object(s.c)("/api/course/api/v1/web/studentHomework/getStudentProgress",e)}function d(e){return Object(s.c)("/api/course/api/v1/web/studentHomework/getHomeworkTestInfoList",e)}function f(e){return Object(s.c)("/api/course/api/v1/web/studentHomework/updateStudySumSecond",e)}function h(){return Object(s.c)("/api/conf/api/v1/schoolClass/getNowSchoolYear")}function g(e){return Object(s.c)("/api/course/api/v1/web/studentHomework/checkHomework",e)}},2400:function(e,t,n){},2779:function(e,t,n){"use strict";n.r(t);n(67);var s=n(28),a=n.n(s),r=(n(381),n(277)),o=n.n(r),i=(n(155),n(53)),c=n.n(i),l=(n(135),n(73)),u=n.n(l),m=(n(40),n(5)),d=n.n(m),f=(n(43),n(2)),h=n.n(f),g=(n(97),n(14)),w=n.n(g),k=(n(45),n(6)),p=n.n(k),b=n(3),I=n.n(b),v=(n(54),n(15)),x=n.n(v),T=n(7),y=n(9),A=n(12),S=n(52),E=n(11),N=n(10),L=(n(51),n(22)),j=n.n(L),F=n(0),O=n.n(F),V=(n(2400),{icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"}),B=n(238),C=function(e,t){return F.createElement(B.a,Object.assign({},e,{ref:t,icon:V}))};C.displayName="CheckOutlined";var D=F.forwardRef(C),H=n(1766),U=j.a.TextArea,M=function(e){Object(E.a)(s,e);var t=Object(N.a)(s);function s(){var e;Object(y.a)(this,s);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={valueList:[],ModalText:"\u8fd8\u6709\u672a\u4f5c\u7b54\u7684\u8bd5\u9898\uff0c\u662f\u5426\u7ee7\u7eed\u63d0\u4ea4\uff1f ",visible:!1,ssssss:!0,courseTestValue:"",timeVisible:!1,confirmLoading:!1,value:"",examId:e.props.match.params.examId,homeworkId:e.props.match.params.homeworkId,studyProgressSum:0,userId:"",homeworkDetail:{},testFormInfoVos:[],examTestInfoVos:[],oneTestList:{},nextTestList:{},blankAnswerList:[],juniorTestInfoVos:{},chooseTestAnswer:[],testString:{},optionAnswer:"",timer:null,timing:"",testHead:"",mm:0,hh:0,ss:0,isClick:!0,resourceId:"",collectFlag:1,roundNUm:0,nextTime:1e3,blankAnswerVisible:!1,cardAnswerVisible:!1,nothingnessVisible:!1,lastAnswerVisible:!1,messageInfo:"",allTestList:[],maxIndex:0,valueNum:0},e.iIiming=function(){var t=e.state,n=t.mm,s=t.timing,a=t.ss,r=t.hh;e.timing=setInterval((function(){s="",60===++a&&(60===++n&&(24===++r&&(r=0),n=0),a=0),s+=r<10?"0"+r:r,s+=":",s+=n<10?"0"+n:n,s+=":",s+=a<10?"0"+a:a,e.setState({timing:s})}),1e3)},e.iTimer=function(){var t=e.state.homeworkDetail,n=new Date,s=n.getFullYear(),a=n.getMonth()+1;a=a<10?"0"+a:a;var r=n.getDate();r=r<10?"0"+r:r;var o=n.getHours();o=o<10?"0"+o:o;var i=n.getMinutes(),c=n.getSeconds(),l=s+"-"+a+"-"+r+" "+o+":"+(i=i<10?"0"+i:i)+":"+(c=c<10?"0"+c:c);e.timer=setInterval((function(){e.compareTime(t.studyEndTime,l)&&(e.setState({timeVisible:!0}),clearInterval(e.timer))}),1e3)},e.compareTime=function(e,t){if(e.length>0&&t.length>0){var n=e.split(" "),s=t.split(" "),a=n[0].split("-"),r=s[0].split("-"),o=n[1].split(":"),i=s[1].split(":"),c=new Date(a[0],a[1],a[2],o[0],o[1],o[2]),l=new Date(r[0],r[1],r[2],i[0],i[1],i[2]);return!(c.getTime()>=l.getTime())}return!1},e.goBack=function(){var t=e.state,n=t.homeworkId,s={studySumSecond:t.timing,homeworkId:n,studentId:t.userId};Object(H.l)(s).then((function(t){0===t.code&&e.props.history.goBack()}))},e.showModal=Object(T.a)(I.a.mark((function t(){var n,s,a,r,o,i,c,l,u;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,s=n.examId,a=n.homeworkId,r=n.homeworkDetail,o=n.timing,i=n.userId,c={examId:s,homeworkId:a,studentId:i},t.next=4,Object(H.i)(c);case 4:if(!(t.sent>0)){t.next=9;break}e.setState({visible:!0}),t.next=15;break;case 9:return l={examId:s,homeworkId:a,isForcedSubmission:0,studentId:i,courseId:r.confSubjectId,studySumSecond:o,studyEndTime:r.studyEndTime},t.next=12,Object(H.j)(l);case 12:0===(u=t.sent).code?(x.a.success("\u6210\u529f\u63d0\u4ea4\u4f5c\u4e1a"),setTimeout((function(){e.props.history.go(-2)}),1e3)):-1===u.code?x.a.error(u.message):-2===u.code&&e.setState({nothingnessVisible:!0,messageInfo:u.message}),clearInterval(e.timing);case 15:case"end":return t.stop()}}),t)}))),e.handleOk=Object(T.a)(I.a.mark((function t(){var n,s,a,r,o,i,c,l;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({ModalText:"\u5df2\u63d0\u4ea4,\u8bf7\u7a0d\u7b49\uff01",confirmLoading:!0}),n=e.state,s=n.examId,a=n.homeworkId,r=n.homeworkDetail,o=n.timing,i=n.userId,c={examId:s,homeworkId:a,studentId:i,courseId:r.confSubjectId,isForcedSubmission:0,studySumSecond:o,studyEndTime:r.studyEndTime},t.next=5,Object(H.j)(c);case 5:0===(l=t.sent).code?(setTimeout((function(){e.setState({visible:!1,confirmLoading:!1}),e.props.history.go(-2)}),1e3),x.a.success("\u6210\u529f\u63d0\u4ea4\u4f5c\u4e1a"),clearInterval(e.timing)):-1===l.code?(x.a.error(l.message),e.setState({visible:!1,confirmLoading:!1})):-2===l.code&&e.setState({nothingnessVisible:!0,messageInfo:l.message});case 7:case"end":return t.stop()}}),t)}))),e.handleOkTwo=Object(T.a)(I.a.mark((function t(){var n,s,a,r,o,i,c,l;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({ModalText:"\u5df2\u63d0\u4ea4,\u8bf7\u7a0d\u7b49\uff01",confirmLoading:!0}),n=e.state,s=n.examId,a=n.homeworkId,r=n.homeworkDetail,o=n.timing,i=n.userId,c={examId:s,homeworkId:a,studentId:i,courseId:r.confSubjectId,studyEndTime:r.studyEndTime,studySumSecond:o,isForcedSubmission:1},t.next=5,Object(H.j)(c);case 5:0===(l=t.sent).code?(setTimeout((function(){e.setState({visible:!1,confirmLoading:!1}),e.props.history.go(-2)}),1e3),x.a.success("\u6210\u529f\u63d0\u4ea4\u4f5c\u4e1a")):400===l.code?(x.a.error(l.message),e.setState({visible:!1,confirmLoading:!1})):-2===l.code&&e.setState({nothingnessVisible:!0,messageInfo:l.message});case 7:case"end":return t.stop()}}),t)}))),e.nextBlankAnswer=Object(T.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({blankAnswerVisible:!1,confirmLoading:!1}),e.nextTest(!0);case 2:case"end":return t.stop()}}),t)}))),e.lastBlankAnswer=Object(T.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({lastAnswerVisible:!1,confirmLoading:!1}),e.lastTest(!0);case 2:case"end":return t.stop()}}),t)}))),e.cardBlankAnswer=Object(T.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({cardAnswerVisible:!1,confirmLoading:!1}),e.getTestList(e.state.nextTestList,!0);case 2:case"end":return t.stop()}}),t)}))),e.nothingness=Object(T.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({nothingnessVisible:!1,confirmLoading:!1}),e.props.history.go(-2);case 2:case"end":return t.stop()}}),t)}))),e.handleCancel=Object(T.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({visible:!1});case 1:case"end":return t.stop()}}),t)}))),e.handleCancelTwo=Object(T.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({timeVisible:!1});case 1:case"end":return t.stop()}}),t)}))),e.blankAnswerUnOk=Object(T.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({blankAnswerVisible:!1});case 1:case"end":return t.stop()}}),t)}))),e.lastBlankAnswerUnOk=Object(T.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({lastAnswerVisible:!1});case 1:case"end":return t.stop()}}),t)}))),e.cardBlankAnswerUnOk=Object(T.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({cardAnswerVisible:!1});case 1:case"end":return t.stop()}}),t)}))),e.nothingnessUnOk=Object(T.a)(I.a.mark((function t(){return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({nothingnessVisible:!1});case 1:case"end":return t.stop()}}),t)}))),e.showButton=function(t,n){return 1===t.answerFlag?O.a.createElement(p.a,{type:"index",className:"but-active",onClick:function(){return e.getTestLists(t)},key:n},n+1):O.a.createElement(p.a,{type:"index",onClick:function(){return e.getTestLists(t)},key:n},n+1)},e.showTwoButton=function(t,n,s){return 1===t.answerFlag?O.a.createElement(p.a,{type:"index",className:"but-active",onClick:function(){return e.getTestLists(t)},key:n},s+1,".",n+1):O.a.createElement(p.a,{type:"index",onClick:function(){return e.getTestLists(t)},key:n},s+1,".",n+1)},e.getTestList=function(){var t=Object(T.a)(I.a.mark((function t(n,s){var a,r,o,i,c,l,u,m,d,f,h,g,w,k,p,b,v,T,y,A;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state,r=a.allTestList,o=a.isClick,i=a.homeworkDetail,c=a.optionAnswer,l=a.blankAnswerList,u=a.oneTestList,m=a.valueList,d=a.examId,f=a.homeworkId,h=a.userId,g=a.nextTime,w=a.testFormInfoVos,!o){t.next=14;break}if(e.setState({isClick:!1}),k=Object(S.a)(e),!s){t.next=9;break}if("2"===u.testForm)for(c=e.jsonTest(l),p=1;p<l.length;p++)for(b=0;b<u.courseTestBlank.length;b++)u.courseTestBlank[b].blankId===p&&(u.courseTestBlank[b].myAnswer=l[p]);else if("3"===u.testForm){for(c="",m.forEach((function(e){""===e&&m.shift()})),v=0;v<m.length;v++)c=0===v?m[v]:c+","+m[v];u.myAnswer=c}else u.myAnswer=c;return T={examId:d,autoJudgeFlag:u.autoJudgeFlag,testForm:u.testForm,homeworkId:f,testId:u.testId,studentId:h,courseId:i.confSubjectId,id:u.submitDetailId,submitText:c},t.next=9,Object(H.k)(T).then((function(t){-1===t.code?x.a.error(t.message):-2===t.code?e.setState({nothingnessVisible:!0,messageInfo:t.message}):0===t.code&&(u.answerFlag=t.result)}));case 9:r.map((function(t){if(t.testId===n.testId){var s=[];if("2"===t.testForm)for(var a=t.courseTestBlank,r=0;r<a.length;r++){var o=a[r];s[o.blankId]=o.myAnswer}for(var i="",c=0;c<w.length;c++)for(var l=0;l<w[c].examTestInfoVos.length;l++)if("8"!==w[c].examTestInfoVos[l].testForm)t.testId===w[c].examTestInfoVos[l].testId&&(i=w[c].testFormAllName);else for(var u=0;u<w[c].examTestInfoVos[l].juniorTestInfoVos.length;u++)t.testId===w[c].examTestInfoVos[l].juniorTestInfoVos[u].testId&&(i=w[c].testFormAllName);e.getLength(t.myAnswer,500),e.setState({oneTestList:t,valueList:t.myAnswer.split(","),blankAnswerList:s,optionAnswer:t.myAnswer,testHead:i})}})),e.getStudentProgress(),setTimeout((function(){k.setState({isClick:!0})}),g),y=0,A=setInterval((function(){if(y===g)k.setState({roundNUm:0}),clearInterval(A);else{var e=y/g;k.setState({roundNUm:e}),y+=g/10}}),g/10);case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.getTestLists=function(t){var n=e.state,s=n.oneTestList,a=n.blankAnswerList;if("2"===s.testForm){for(var r=0,o=1;o<a.length;o++)void 0!==a[o]&&""!==a[o]&&null!==a[o]||(r+=1);0!==r&&r!==a.length-1?e.setState({cardAnswerVisible:!0,nextTestList:t}):e.getTestList(t,!0)}else e.getTestList(t,!0)},e.testInfoDetail=function(){var t=e.state,n=t.oneTestList,s=t.blankAnswerList;return"4"===n.testForm?O.a.createElement("div",{className:"Answer-box"},O.a.createElement(w.a.Group,{buttonStyle:"solid",onChange:e.optionButton,value:e.state.optionAnswer},n.chooseTestAnswer?n.chooseTestAnswer.map((function(e,t){return O.a.createElement(w.a.Button,{value:e.optionName,key:t},O.a.createElement("i",{className:"icon"},O.a.createElement(D,null)),e.optionName+"."+e.memo)})):"")):"1"===n.testForm?O.a.createElement(w.a.Group,{buttonStyle:"solid",onChange:e.optionButton,value:e.state.optionAnswer},n.chooseTestAnswer?n.chooseTestAnswer.map((function(e,t){return O.a.createElement(w.a.Button,{value:e.optionName,key:t},e.optionName+"."+e.memo)})):""):"2"===n.testForm?O.a.createElement(u.a,{className:"Fill-tk"},n.courseTestBlank?n.courseTestBlank.map((function(t,a){return O.a.createElement(d.a,{key:a},O.a.createElement(h.a,{span:24,className:"fill-li"},"\u586b\u7a7a",t.blankId,O.a.createElement("span",{className:"inp-fill"},O.a.createElement(j.a,{maxLength:30,placeholder:"\u8bf7\u8f93\u5165\u4f60\u7684\u56de\u7b54",id:t.blankId+"",value:s[t.blankId],onChange:function(t){return e.handleBlankDefaultValue(t)},suffix:O.a.createElement("span",null,n.courseTestBlank[t.blankId-1].myAnswer&&n.courseTestBlank[t.blankId-1].myAnswer.length?n.courseTestBlank[t.blankId-1].myAnswer.length:0,"/30")}))))})):""):"3"===n.testForm?O.a.createElement(c.a.Group,{onChange:e.checkboxButton,className:"Checkbox-dx",value:e.state.valueList},n.chooseTestAnswer?n.chooseTestAnswer.map((function(t,n){return O.a.createElement(c.a,{value:t.optionName,key:n,onChange:function(t){return e.checkboxButtonaffa(t)}},t.optionName,". ",t.memo)})):""):"9"===n.testForm?O.a.createElement("div",{className:"TextArea-pic"},O.a.createElement(U,{maxLength:500,value:e.state.optionAnswer,onChange:e.textAreaChange,placeholder:"\u8bf7\u8f93\u5165\u4f60\u7684\u56de\u7b54",autoSize:{minRows:3,maxRows:5},onKeyUp:e.keyUp}),O.a.createElement("p",{style:{textAlign:"right",paddingRight:" 10px"}},e.state.valueNum,"/500")):void 0},e.optionButton=function(t){e.setState({optionAnswer:t.target.value},(function(){e.returnSelectAnswer(t.target.value)}))},e.textAreaChange=function(t){var n=t.target.value;e.getLength(n,500)},e.returnSelectAnswer=function(t){var n=e.state.oneTestList.myAnswer;return""!==e.state.optionAnswer?e.state.optionAnswer===t:n===t},e.checkboxButton=function(e){},e.checkboxButtonaffa=function(t){var n=t.target.value,s=t.target.checked,a=e.state.valueList;s?a.push(n+""):a.splice(a.findIndex((function(e){return e===n})),1),e.setState({valueList:a,optionAnswer:"1"})},e.handleBlankDefaultValue=function(t){var n=e.state,s=n.blankAnswerList,a=n.oneTestList;s[t.target.id]=t.target.value;for(var r=e.jsonTest(s),o=1;o<s.length;o++)for(var i=0;i<a.courseTestBlank.length;i++)a.courseTestBlank[i].blankId===o&&(a.courseTestBlank[i].myAnswer=s[o]);a.myAnswer=r,""===t.target.value&&a.answerFlag,e.setState({blankAnswerList:s})},e.getLastStyle=function(){return"next"},e.nextTests=Object(T.a)(I.a.mark((function t(){var n,s,a,r,o;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.state,s=n.oneTestList,a=n.blankAnswerList,"2"===s.testForm){for(r=0,o=1;o<a.length;o++)void 0!==a[o]&&""!==a[o]&&null!==a[o]||(r+=1);0!==r&&r!==a.length-1?e.setState({blankAnswerVisible:!0}):e.nextTest(!0)}else e.nextTest(!0);case 2:case"end":return t.stop()}}),t)}))),e.lastTests=Object(T.a)(I.a.mark((function t(){var n,s,a,r,o;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.state,s=n.oneTestList,a=n.blankAnswerList,"2"===s.testForm){for(r=0,o=1;o<a.length;o++)void 0!==a[o]&&""!==a[o]&&null!==a[o]||(r+=1);0!==r&&r!==a.length-1?e.setState({lastAnswerVisible:!0}):e.lastTest(!0)}else e.lastTest(!0);case 2:case"end":return t.stop()}}),t)}))),e.nextTest=function(){var t=Object(T.a)(I.a.mark((function t(n){var s,a,r,o,i,c,l,u,m,d,f,h,g,w,k,p,b,v,T;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=e.state,a=s.oneTestList,r=s.homeworkDetail,o=s.maxIndex,i=s.examId,c=s.homeworkId,l=s.userId,u=s.blankAnswerList,m=s.valueList,d=s.isClick,s.roundNUm,f=s.nextTime,h=s.optionAnswer,!d){t.next=18;break}if(e.setState({isClick:!1}),g=Object(S.a)(e),a.curIndex+1===o&&x.a.warning("\u6ca1\u6709\u4e0b\u4e00\u9898\u4e86"),!n){t.next=13;break}if("2"===a.testForm)for(h=e.jsonTest(u),w=1;w<u.length;w++)for(k=0;k<a.courseTestBlank.length;k++)a.courseTestBlank[k].blankId===w&&(a.courseTestBlank[k].myAnswer=u[w]);else if("3"===a.testForm){for(h="",m.forEach((function(e){""===e&&m.shift()})),p=0;p<m.length;p++)h=0===p?m[p]:h+","+m[p];a.myAnswer=h}else a.myAnswer=h;return b={examId:i,courseId:r.confSubjectId,seniorId:a.seniorId,autoJudgeFlag:a.autoJudgeFlag,testForm:a.testForm,homeworkId:c,testId:a.testId,studentId:l,id:a.submitDetailId,submitText:h},t.next=11,Object(H.k)(b).then((function(t){-1===t.code?x.a.error(t.message):-2===t.code?e.setState({nothingnessVisible:!0,messageInfo:t.message}):0===t.code&&(a.answerFlag=t.result,e.getTestInfoByIndex(a.curIndex+1))}));case 11:t.next=14;break;case 13:e.getTestInfoByIndex(a.curIndex+1);case 14:e.getStudentProgress(),setTimeout((function(){g.setState({isClick:!0})}),f),v=0,T=setInterval((function(){if(v===f)g.setState({roundNUm:0}),clearInterval(T);else{var e=v/f;g.setState({roundNUm:e}),v+=f/10}}),f/10);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.keyUp=function(e){},e}return Object(A.a)(s,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).user.id:"";this.setState({userId:e}),this.getHomeworkDetail(e)}},{key:"componentWillUnmount",value:function(){var e=this.state,t=e.homeworkId,n={studySumSecond:e.timing,homeworkId:t,studentId:e.userId};Object(H.l)(n)}},{key:"getStudentProgress",value:function(){var e=Object(T.a)(I.a.mark((function e(){var t,n,s,a,r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.homeworkDetail,s=t.homeworkId,a=t.userId,r={catalogId:n.catalogId,homeworkId:s,studentId:a},e.next=4,Object(H.h)(r);case 4:o=e.sent,this.setState({studyProgressSum:parseInt(o)});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHomeworkDetail",value:function(){var e=Object(T.a)(I.a.mark((function e(t){var n,s,a,r,o,i,c,l,u,m,d,f,h,g,w,k,p,b,v,x,T,y,A;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state,s=n.examId,a=n.homeworkId,r={examId:s,homeworkId:a,userId:t},e.next=4,Object(H.d)(r);case 4:for(o=e.sent,i=o.testFormInfoVos,c=[],l=0;l<i.length;l++)if(u=i[l],m=u.testForm,d=u.examTestInfoVos,"8"===m)for(f=0;f<d.length;f++)for(h=d[f],g=h.juniorTestInfoVos,w=0;w<g.length;w++)c.push(g[w]);else for(k=0;k<d.length;k++)p=d[k],c.push(p);for(b=0;b<c.length;b++)c[b].curIndex=b;if(v=c[0],x=[],"2"===v.testForm)for(T=v.courseTestBlank,y=0;y<T.length;y++)A=T[y],x[A.blankId]=A.myAnswer;this.setState({allTestList:c,maxIndex:c.length,oneTestList:v,hh:o.hh,mm:o.mm,ss:o.ss,homeworkDetail:o,testFormInfoVos:o.testFormInfoVos,valueList:v.myAnswer.split(","),blankAnswerList:x,optionAnswer:v.myAnswer,testHead:o.testFormInfoVos[0].testFormAllName}),this.getLength(v.myAnswer,500),this.getStudentProgress(),setTimeout(this.iTimer,0),this.iIiming();case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTestInfoByIndex",value:function(e){var t=this,n=this.state,s=n.allTestList,a=n.testFormInfoVos;return s.map((function(n){if(n.curIndex===e){var s=[];if("2"===n.testForm)for(var r=n.courseTestBlank,o=0;o<r.length;o++){var i=r[o];s[i.blankId]=i.myAnswer}for(var c="",l=0;l<a.length;l++)for(var u=0;u<a[l].examTestInfoVos.length;u++)if("8"!==a[l].examTestInfoVos[u].testForm)n.testId===a[l].examTestInfoVos[u].testId&&(c=a[l].testFormAllName);else for(var m=0;m<a[l].examTestInfoVos[u].juniorTestInfoVos.length;m++)n.testId===a[l].examTestInfoVos[u].juniorTestInfoVos[m].testId&&(c=a[l].testFormAllName);t.getLength(n.myAnswer,500),t.setState({oneTestList:n,valueList:n.myAnswer.split(","),blankAnswerList:s,optionAnswer:n.myAnswer,testHead:c})}}))}},{key:"getLength",value:function(e,t){var n=new String(e),s=0,a="";if(this.state.valueNum<=t){""==n&&this.setState({valueNum:0});for(var r=0,o=n.length;r<o;r++){n.charCodeAt(r);s<t&&(s+=1,a+=n[r],this.setState({valueNum:s}))}return this.setState({value:a,optionAnswer:a}),a}}},{key:"returnValue",value:function(){for(var e=this.state.oneTestList,t=[],n=0;n<e.chooseTestAnswer.length;n++)t[n]=e.chooseTestAnswer[n].optionName;return t}},{key:"jsonTest",value:function(e){for(var t=[],n=1;n<e.length;n++){var s={blankId:n,myAnswer:e[n]};t.push(s)}return JSON.stringify(t)}},{key:"getNextStyle",value:function(){return"next"}},{key:"getThematicStem",value:function(){var e=this.state,t=e.testFormInfoVos,n=e.oneTestList;e.homeworkDetail;if(t.length>0){n.testForm;if("0"===n.seniorId)return null;var s="",a="";return t.map((function(e){if("8"===e.testForm)e.examTestInfoVos.map((function(e){e.testId===n.seniorId&&(s=e.testIndex,a=e.stem)}))})),O.a.createElement("div",null,O.a.createElement("h4",{className:"title2"},s,".\xa0",a))}}},{key:"returnTestFormName",value:function(e){return"1"===e?"\u9009\u62e9\u9898":"2"===e?"\u586b\u7a7a\u9898":"3"===e?"\u591a\u9009\u9898":"4"===e?"\u5224\u65ad\u9898":"9"===e?"\u89e3\u7b54\u9898":void 0}},{key:"subtopicStem",value:function(){var e=this.state.oneTestList;if("0"===e.seniorId){var t=e.testIndex+". "+e.stem;return O.a.createElement("h4",{className:"title1"},t)}return O.a.createElement("h4",{className:"title3"},O.a.createElement("span",null,e.testIndex),O.a.createElement("span",null,"(\xa0",this.returnTestFormName(e.testForm),"\xa0)"),O.a.createElement("span",null,e.stem))}},{key:"lastTest",value:function(){var e=Object(T.a)(I.a.mark((function e(t){var n,s,a,r,o,i,c,l,u,m,d,f,h,g,w,k,p,b,v=this;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,s=n.oneTestList,a=n.examId,r=n.homeworkDetail,o=n.homeworkId,i=n.userId,c=n.blankAnswerList,l=n.valueList,u=n.isClick,n.roundNUm,m=n.nextTime,d=n.optionAnswer,!u){e.next=19;break}if(this.setState({isClick:!1}),f=this,!(s.curIndex-1<0)){e.next=9;break}x.a.warning("\u6ca1\u6709\u4e0a\u4e00\u9898\u4e86"),e.next=14;break;case 9:if(!t){e.next=14;break}if("2"===s.testForm)for(d=this.jsonTest(c),h=1;h<c.length;h++)for(g=0;g<s.courseTestBlank.length;g++)s.courseTestBlank[g].blankId===h&&(s.courseTestBlank[g].myAnswer=c[h]);else if("3"===s.testForm){for(d="",l.forEach((function(e){""===e&&l.shift()})),w=0;w<l.length;w++)d=0===w?l[w]:d+","+l[w];s.myAnswer=d}else s.myAnswer=d;return k={examId:a,seniorId:s.seniorId,autoJudgeFlag:s.autoJudgeFlag,testForm:s.testForm,homeworkId:o,courseId:r.confSubjectId,testId:s.testId,studentId:i,id:s.submitDetailId,submitText:d},e.next=14,Object(H.k)(k).then((function(e){-1===e.code?x.a.error(e.message):-2===e.code?v.setState({nothingnessVisible:!0,messageInfo:e.message}):0===e.code&&(s.answerFlag=e.result,v.getTestInfoByIndex(s.curIndex-1))}));case 14:this.getTestInfoByIndex(s.curIndex-1),this.getStudentProgress(),setTimeout((function(){f.setState({isClick:!0})}),m),p=0,b=setInterval((function(){if(p===m)f.setState({roundNUm:0}),clearInterval(b);else{var e=p/m;f.setState({roundNUm:e}),p+=m/10}}),m/10);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,s=t.visible,r=t.confirmLoading,i=t.ModalText,c=t.blankAnswerVisible,l=t.isClick,u=t.homeworkDetail,m=t.testFormInfoVos,f=t.timeVisible,h=t.lastAnswerVisible,g=t.cardAnswerVisible,w=t.nothingnessVisible,k=t.timing,b=t.testHead,I=t.studyProgressSum,v=t.roundNUm,x=t.messageInfo;return O.a.createElement("div",{className:"my-operation-answer"},O.a.createElement("div",{className:"answer-pic"},O.a.createElement("div",{className:"top"},O.a.createElement("span",{className:"img",style:{width:"85px"}}," ",O.a.createElement("a",{className:"preview-f",onClick:this.goBack.bind(this)},O.a.createElement("img",{src:n(521),style:{float:"left"},alt:""}),O.a.createElement("span",{className:"text-back",style:{float:"left",fontSize:"16px",color:"#2A283D"}},"\u8fd4\u56de"))),u.homeworkName),O.a.createElement("div",{className:"begin-answer"},O.a.createElement("div",{className:"answer-box clearfix"},O.a.createElement("div",{className:"left clearfix"},O.a.createElement("h3",{className:"title"},b),O.a.createElement("div",{className:"titlea"},this.getThematicStem(),this.subtopicStem()),O.a.createElement("div",{className:"text"},this.testInfoDetail()),O.a.createElement("div",{className:"Use-time"},O.a.createElement("span",{className:this.getLastStyle()},!0===l?O.a.createElement(p.a,{type:"\u4e0a\u4e00\u9898",className:"but-active",onClick:function(){return e.lastTests()}},"\u4e0a\u4e00\u9898"):O.a.createElement("div",{className:"Progress"},O.a.createElement(o.a,{percent:100*v,className:"buton",strokeColor:"#3BB9FF"}),O.a.createElement("span",{className:"span"},100*v,"%"))),O.a.createElement("div",{className:"time1"},O.a.createElement("i",{className:"i"},"\u7528\u65f6",k),O.a.createElement(o.a,{percent:I,format:function(e){return"\u5b66\u4e60\u8fdb\u5ea6\uff1a".concat(I,"%")}})),O.a.createElement("span",{className:this.getNextStyle()},!0===l?O.a.createElement(p.a,{type:"\u4e0b\u4e00\u9898",className:"but-active",onClick:function(){return e.nextTests()}},"\u4e0b\u4e00\u9898"):O.a.createElement("div",{className:"Progress"},O.a.createElement(o.a,{percent:100*v,className:"buton",strokeColor:"#3BB9FF"}),O.a.createElement("span",{className:"span"},100*v,"%"))))),O.a.createElement("div",{className:"right clearfix"},O.a.createElement("div",{className:"border-pic"},O.a.createElement("div",{className:"right-top"},O.a.createElement("span",{className:"title"},"\u7b54\u9898\u5361"),O.a.createElement("div",{className:"tab"},O.a.createElement("span",{className:"i"},"\u672a\u505a"),O.a.createElement("span",{className:"i i-active"},"\u5df2\u505a")))),O.a.createElement(d.a,{className:"pic-obtn"},m?m.map((function(t,n){return O.a.createElement("div",{className:"list-tab",key:n},O.a.createElement("h4",{className:"title1"},t.testFormAllName),O.a.createElement("div",{className:"list-but"},t.examTestInfoVos?t.examTestInfoVos.map((function(t,s){return"1"===t.testForm||"2"===t.testForm||"3"===t.testForm||"4"===t.testForm||"9"===t.testForm?e.showButton(t,s,n):t.juniorTestInfoVos?t.juniorTestInfoVos.map((function(t,a){return e.showTwoButton(t,a,s,n)})):""})):""))})):"")))),O.a.createElement("div",{className:"begin-subm"},O.a.createElement("span",{className:"span"},"\u622a\u6b62\u65f6\u95f4:",u.studyEndTime),O.a.createElement("div",{className:"subm-inp"},O.a.createElement(p.a,{type:"primary",onClick:this.showModal},"\u63d0\u4ea4\u4f5c\u4e1a"),O.a.createElement(a.a,{className:"Modal-but",title:"\u63d0\u4ea4\u4f5c\u4e1a",visible:s,onOk:this.handleOk,confirmLoading:r,onCancel:this.handleCancel,closable:!1},O.a.createElement("p",null,i)),O.a.createElement(a.a,{className:"Modal-but",title:"\u63d0\u4ea4\u4f5c\u4e1a",visible:f,onOk:this.handleOkTwo,confirmLoading:r,onCancel:this.handleCancelTwo,closable:!1},O.a.createElement("p",null,"\u8bd5\u5377\u5df2\u7ecf\u8fc7\u671f\uff0c\u662f\u5426\u63d0\u4ea4\u8bd5\u5377")),O.a.createElement(a.a,{className:"Modal-but",title:"\u662f\u5426\u63d0\u4ea4",visible:c,onOk:this.nextBlankAnswer,confirmLoading:r,onCancel:this.blankAnswerUnOk,closable:!1},O.a.createElement("p",null,"\u8fd8\u6709\u672a\u586b\u7684\u7a7a\uff0c\u786e\u5b9a\u8981\u63d0\u4ea4\u8fd9\u4e00\u9898\u5417\uff1f")),O.a.createElement(a.a,{className:"Modal-but",title:"\u662f\u5426\u63d0\u4ea4",visible:h,onOk:this.lastBlankAnswer,confirmLoading:r,onCancel:this.lastBlankAnswerUnOk,closable:!1},O.a.createElement("p",null,"\u8fd8\u6709\u672a\u586b\u7684\u7a7a\uff0c\u786e\u5b9a\u8981\u63d0\u4ea4\u8fd9\u4e00\u9898\u5417\uff1f")),O.a.createElement(a.a,{className:"Modal-but",title:"\u662f\u5426\u63d0\u4ea4",visible:g,onOk:this.cardBlankAnswer,confirmLoading:r,onCancel:this.cardBlankAnswerUnOk,closable:!1},O.a.createElement("p",null,"\u8fd8\u6709\u672a\u586b\u7684\u7a7a\uff0c\u786e\u5b9a\u8981\u63d0\u4ea4\u8fd9\u4e00\u9898\u5417\uff1f")),O.a.createElement(a.a,{className:"Modal-but",title:x,visible:w,onOk:this.nothingness,okText:"\u6211\u77e5\u9053\u4e86",confirmLoading:r,onCancel:this.nothingnessUnOk,closable:!1})))))}}]),s}(F.Component);t.default=M}}]);