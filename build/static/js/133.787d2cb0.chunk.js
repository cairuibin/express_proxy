(this.webpackJsonpzjyz_admin=this.webpackJsonpzjyz_admin||[]).push([[133],{2139:function(e,t,a){},2689:function(e,t,a){"use strict";a.r(t);a(41);var s=a(8),r=a.n(s),n=(a(109),a(72)),o=a.n(n),c=(a(177),a(110)),i=a.n(c),u=(a(74),a(17)),l=a.n(u),m=(a(97),a(14)),d=a.n(m),h=(a(135),a(73)),p=a.n(h),g=(a(45),a(6)),f=a.n(g),y=(a(43),a(2)),v=a.n(y),k=(a(40),a(5)),S=a.n(k),b=a(98),C=(a(54),a(15)),I=a.n(C),T=a(3),E=a.n(T),N=a(7),O=a(20),j=a(9),x=a(12),L=a(52),F=a(11),w=a(10),B=(a(276),a(83)),M=a.n(B),_=(a(51),a(22)),z=a.n(_),D=(a(67),a(28)),V=a.n(D),A=(a(79),a(30)),R=a.n(A),P=(a(178),a(82)),Q=a.n(P),Y=(a(204),a(101)),K=a.n(Y),q=a(0),J=a.n(q),U=(a(2139),a(44)),G=a(27),H=a(102),W=(a(99),a(181)),$=a(39),X=a(240),Z=a(318),ee=a(93),te=a(242),ae=a(241),se=a(319),re=a(136),ne=a(540),oe=a(31),ce=(K.a.TabPane,Q.a.TreeNode),ie=R.a.Option,ue=V.a.confirm,le=z.a.Search,me=(M.a.SubMenu,function(e){Object(F.a)(s,e);var t=Object(w.a)(s);function s(){var e;Object(j.a)(this,s);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={userId:"",myCourseList:[],mySubjectList:[],courseTree:[],selectCatalogId:void 0,bookId:void 0,subjectId:void 0,stageId:void 0,catalogStageId:void 0,catalogSubjectId:void 0,knowledgeStageId:void 0,knowledgeSubjectId:void 0,activeKey:"1",catalogArray:[],catalogArrayChecked:[],pointsArray:[],pointsArrayChecked:[],createUserId:void 0,courseCloudFlag:"1",myUnitId:"",testCateCheck:"",testRealCheck:"",examYearCheck:"",selectType:"",regionCheck:"",shareModel:"",unitId:"",resourceProvince:"",resourceCity:"",resourceCounty:"",testDetail:"",size:"small",AnalyzeTestModal:!1,ErrorTestModal:!1,testId:"",resourceId:"",similarTestModal:!1,addTestModal:!1,isObligation:!0,isOrdinary:!1,courseTestList:[],total:0,pageNum:1,pageSize:10,testForm:[],testDiff:[],testCate:[],testReal:[],examYearList:[],unitList:[],unitListAll:[],testSourceList:[{label:"\u6570\u5b57\u6559\u6750",value:"4"},{label:"\u6821\u5185\u5171\u4eab",value:"2"},{label:"\u4e91\u5171\u4eab",value:"1"}],testSourceValue:"",region:[],testDiffMap:{},showAnswer:!1,testFormList:[],testBasketIdList:[],testBasketMax:40,orderAscfield:"",orderDescfield:"a.create_time",sortSet:{value:"zh",zhOrder:!0,zjOrder:!0,ndOrder:!0},provinceData:[],cityData:[],countyData:[],addressVisible:!1,examYearVisible:!1,testSourceVisible:!1,resourceProvinceName:"",resourceCityName:"",resourceCountyName:"",examYearName:"",myjsonData:"",typeValue:"",searchValueSchool:void 0,searchValuePage:void 0,lineValue:"",courseSchoolFlag:0,keys:"",level:"",randomkey:e.randomkey(),examTypeId:"",historyType:"",schoolQuestionBank_1:sessionStorage.getItem("schoolQuestionBank_1")?sessionStorage.getItem("schoolQuestionBank_1"):"",schoolQuestionBank_2:sessionStorage.getItem("schoolQuestionBank_2")?sessionStorage.getItem("schoolQuestionBank_2"):"",iSGoHomeWork:!1},e.onProvinceChange=function(t,a){var s=t.target.value,r=""===s?"":s.value,n=""===s?"":s.title;e.setState({resourceProvince:r,resourceCity:"",resourceCounty:"",resourceProvinceName:n,resourceCityName:"",resourceCountyName:"",cityData:[],countyData:[]},(function(){e.getCourseTestList(),Object(G.w)({parentCode:r}).then((function(t){r?e.setState({cityData:t}):e.setState({addressVisible:!1})}))}))},e.onCityChange=function(t,a){var s=t.target.value,r=""===s?"":s.value,n=""===s?"":s.title;e.setState({resourceCity:r,resourceCounty:"",resourceCityName:n,resourceCountyName:"",countyData:[]},(function(){e.getCourseTestList(),Object(G.w)({parentCode:r}).then((function(t){r?e.setState({countyData:t}):e.setState({addressVisible:!1})}))}))},e.onCountyChange=function(t,a){var s=t.target.value,r=""===s?"":s.value,n=""===s?"":s.title;e.setState({resourceCounty:r,resourceCountyName:n,addressVisible:!1},(function(){return e.getCourseTestList()}))},e.testFormChange=function(t){sessionStorage.setItem("schoolQuestionBank_1",t.target.value),e.setState({pageNum:1,schoolQuestionBank_1:t.target.value},(function(){e.getCourseTestList()}))},e.testDiffChange=function(t){sessionStorage.setItem("schoolQuestionBank_2",t.target.value),e.setState({pageNum:1,schoolQuestionBank_2:t.target.value},(function(){e.getCourseTestList()}))},e.examYearChange=function(t){var a=t.target.value;e.setState({examYearName:""===a?"":a.key}),a&&"\u66f4\u65e9"===a.key?e.setState({pageNum:1,examYearCheck:a.value,selectType:1,examYearVisible:!1},(function(){e.getCourseTestList()})):e.setState({pageNum:1,examYearCheck:a.value,selectType:0,examYearVisible:!1},(function(){e.getCourseTestList()}))},e.testSourceChange=function(t){var a=t.target.value;""===a||"1"===a||"2"===a||"4"===a?e.setState({pageNum:1,shareModel:a,testSourceValue:a,unitId:"",testSourceVisible:!1},(function(){e.getCourseTestList()})):e.setState({pageNum:1,shareModel:"5",unitId:a,testSourceValue:a,testSourceVisible:!1},(function(){e.getCourseTestList()}))},e.zhClick=function(){var t=e.state.sortSet;"zh"===t.value?(t.zhOrder=!t.zhOrder,e.setState({sortSet:t},(function(){e.testOrderChange(t.zhOrder,"a.create_time")}))):e.setState({sortSet:Object(O.a)(Object(O.a)({},t),{},{zhOrder:!0,value:"zh"})},(function(){e.testOrderChange(t.zhOrder,"a.create_time")}))},e.zjClick=function(){var t=e.state.sortSet;"zj"===t.value?(t.zjOrder=!t.zjOrder,e.setState({sortSet:t},(function(){e.testOrderChange(t.zjOrder,"h.used_num")}))):e.setState({sortSet:Object(O.a)(Object(O.a)({},t),{},{zjOrder:!0,value:"zj"})},(function(){e.testOrderChange(t.zjOrder,"h.used_num")}))},e.ndClick=function(){var t=e.state.sortSet;"nd"===t.value?(t.ndOrder=!t.ndOrder,e.setState({sortSet:t},(function(){e.testOrderChange(t.ndOrder,"h.collect_num")}))):e.setState({sortSet:Object(O.a)(Object(O.a)({},t),{},{ndOrder:!0,value:"nd"})},(function(){e.testOrderChange(t.ndOrder,"h.collect_num")}))},e.testOrderChange=function(t,a){t?e.setState({pageNum:1,orderAscfield:"",orderDescfield:a},(function(){e.getCourseTestList()})):e.setState({pageNum:1,orderAscfield:a,orderDescfield:""},(function(){e.getCourseTestList()}))},e.onShowSizeChange=function(t,a){e.setState({pageNum:1,pageSize:a},(function(){e.getCourseTestList()}))},e.onPageNumChange=function(t,a){e.setState({pageNum:t},(function(){e.getCourseTestList()}))},e.tabChange=function(t){"1"===t?e.setState({pageNum:1,activeKey:t,createUserId:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).user.id:"",courseCloudFlag:"",courseCollectFlag:"",courseSchoolFlag:"",shareModel:"",testSourceValue:"",searchValueSchool:"",searchValue:""},(function(){return e.getCourseTestList()})):"2"===t?e.setState({pageNum:1,activeKey:t,testRealCheck:"",examYearCheck:"",regionCheck:"",shareModel:"",testSourceValue:"",unitId:"",resourceProvinceName:"",resourceCityName:"",resourceCountyName:"",examYearName:"",resourceProvince:"",resourceCity:"",resourceCounty:"",cityData:[],countyData:[],searchValueSchool:"",searchValue:"",createUserId:void 0,courseCloudFlag:"",courseCollectFlag:"",courseSchoolFlag:"1"},(function(){return e.getCourseTestList()})):"3"===t?e.setState({pageNum:1,activeKey:t,shareModel:"",testSourceValue:"",searchValueSchool:"",searchValue:"",createUserId:void 0,courseCloudFlag:"1",courseCollectFlag:"",courseSchoolFlag:""},(function(){return e.getCourseTestList()})):e.setState({pageNum:1,activeKey:t,shareModel:"",testSourceValue:"",searchValueSchool:"",searchValue:"",createUserId:void 0,courseCloudFlag:"",courseCollectFlag:"1",courseSchoolFlag:""},(function(){return e.getCourseTestList()}))},e.showAnswerChange=function(t,a){e.setState({showAnswer:t})},e.obligationClick=function(){var t=e.state,a=t.catalogStageId,s=t.catalogSubjectId,r=t.catalogArrayChecked;e.setState({stageId:a,subjectId:s,catalogArray:r,pointsArray:[],isObligation:!0,isOrdinary:!1,pageNum:1,courseTestList:[],total:0},(function(){e.getTestIdList(),e.getTestFormList(),a&&s&&(e.getCourseListTreeNew(),e.getCourseTestList())}))},e.ordinaryOnClick=function(){var t=e.state,a=t.knowledgeStageId,s=t.knowledgeSubjectId,r=t.pointsArrayChecked;e.setState({stageId:a,subjectId:s,catalogArray:[],pointsArray:r,isOrdinary:!0,isObligation:!1,pageNum:1,courseTestList:[],total:0},(function(){e.getTestIdList(),e.getTestFormList(),a&&s&&e.getCourseTestList()}))},e.collectChange=function(){var t=Object(N.a)(E.a.mark((function t(a){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(W.a)({userId:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).user.id:"",resourceId:a});case 2:e.getCourseTestList();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.analyzeTestModal=function(t){e.setState({AnalyzeTestModal:!0,testDetail:t})},e.analyzeCancel=function(){e.setState({AnalyzeTestModal:!1})},e.errorTestModal=function(t){e.setState({ErrorTestModal:!0,testId:t})},e.errorTestCancel=function(){e.setState({ErrorTestModal:!1})},e.errorTestSave=function(){e.ErrorTestForm.props.form.validateFields((function(t,a){if(!t){var s=e.ErrorTestForm.getItemsValue(),r={errorTypeList:s&&s.patternValue.map((function(e){return{errorType:e}})),errorMemo:s.errorMemo,testId:e.state.testId};Object(H.b)(r).then((function(t){e.ErrorTestForm.resetFields(),e.setState({ErrorTestModal:!1}),I.a.success("\u63d0\u4ea4\u6210\u529f\uff01")}))}}))},e.similarTestModal=function(t){e.setState({similarTestModal:!0,testId:t})},e.similarTestCancel=function(){e.setState({similarTestModal:!1})},e.addTestModal=function(t){0==t.whetherJoin?e.setState({testId:t.id,resourceId:t.resourceId,addTestModal:!0,lineValue:{id:t.id,subjectName:t.subjectName}}):Object($.m)({resourceId:t.resourceId}).then((function(t){I.a.success("\u5220\u9664\u6210\u529f!"),e.getCourseTestList()}))},e.addTestCancel=function(){e.setState({addTestModal:!1})},e.courseTestSave=function(){e.AddTestForm.props.form.validateFields((function(t,a){if(!t){var s=e.state,r=s.resourceId,n=s.testId,o=e.AddTestForm.getItemsValue();Object($.y)({testId:n,resourceId:r,catalogId:o.catalogId,confSubjectId:o.courseId}).then((function(t){I.a.success("\u6dfb\u52a0\u6210\u529f"),e.setState({addTestModal:!1}),e.getCourseTestList()}))}}))},e.deleteTest=function(t){var a=Object(L.a)(e);ue({title:"\u63d0\u793a?",content:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u6062\u590d!",okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){Object(H.a)(t).then((function(e){I.a.success("\u5220\u9664\u6210\u529f"),a.setState({pageNum:1},(function(){a.getCourseTestList()}))}))}})},e.editTest=function(t){e.props.history.push({pathname:"/teaching/question-bank/create-test",state:t})},e.bookChange=function(t){sessionStorage.setItem("questionOne",""),sessionStorage.setItem("questionTwo",""),sessionStorage.setItem("questionThree",""),sessionStorage.setItem("schoolQuestionBank_1",""),sessionStorage.setItem("schoolQuestionBank_2",""),sessionStorage.setItem("platformQuestionBank_1",""),sessionStorage.setItem("platformQuestionBank_2",""),sessionStorage.setItem("questionCollection_1",""),sessionStorage.setItem("questionCollection_2",""),e.setState({schoolQuestionBank_1:"",schoolQuestionBank_2:""});var a=e.state.subjectList,s="",r="";sessionStorage.setItem("resourceBookId",t),sessionStorage.setItem("resourceParentKeys",""),sessionStorage.setItem("resourceLibraryKeys",[]),a.forEach((function(e){e.id===t&&(s=e.stageId,r=e.subjectId)})),e.setState({randomkey:e.randomkey(),resourceParentKeys:[0],keys:"",seniorId:"",pageNum:1,bookId:t,catalogArray:[],catalogArrayChecked:[],selectCatalogId:"",stageId:s,catalogStageId:s,catalogSubjectId:r},(function(){e.getCourseTestList()}))},e.classifyCheck=function(t,a){var s,r="";a.selectedNodes&&a.selectedNodes.length>0&&a.selectedNodes[0].props.dataRef&&(s=a.selectedNodes[0].props.dataRef.level,r=a.selectedNodes[0].props.dataRef),sessionStorage.setItem("resourceLibraryKeys",[t,s]);var n=[];if(3==r.level&&e.state.courseTree.length>0){!function e(t){return t&&t.length>0?t.map((function(t){t.id!=r.parentId?e(t.children):n.push(t.parentId)})):""}(e.state.courseTree)}r&&(n.push(a.selectedNodes[0].props.dataRef.parentId),n.push(t)),sessionStorage.setItem("resourceParentKeys",n),e.setState({pageNum:1,catalogArray:t,catalogArrayChecked:t,selectCatalogId:t?t[0]:"",level:s,examTypeId:t?t[0]:""},(function(){e.getCourseTestList()}))},e.knowledgePointCheck=function(t,a){e.setState({pageNum:1,pointsArrayChecked:t,pointsArray:t},(function(){e.getCourseTestList()}))},e.renderTreeNodes=function(t){return t.map((function(t){return 0==t.bottom?J.a.createElement(ce,{title:J.a.createElement("div",{className:"TreeIcon"},t.name),key:t.id,dataRef:t},t.children&&t.children.length>0?e.renderTreeNodes(t.children):""):J.a.createElement(ce,{switcherIcon:J.a.createElement("span",{className:"TreeCircleIcon"}),title:t.name,key:t.id,value:t.id,dataRef:t})}))},e.selectMenu=function(t,a){var s=e.state,r=s.testFormList,n=(s.testForm,Object(b.a)(r)),o=e.testFormFilter(t);return r.includes(o)||n.push(o),J.a.createElement(M.a,null,n&&n.length>0?n.map((function(t,s){return J.a.createElement(M.a.Item,{key:s},J.a.createElement("a",{onClick:function(){return e.saveTestBasket(a,t)}},t))})):"")},e.testDiffFilter=function(t){return e.state.testDiffMap[t]},e.testRealFilter=function(t){var a=e.state.testRealMap;return a?a[t]:""},e.testFormFilter=function(t){return e.state.testFormMap[t]},e.getStem=function(t,a,s){var r=0===s?J.a.createElement("span",null,a+1+"\u3001"+(1===t.examFlag?"\uff08".concat(t.examYear," \xb7 ").concat(t.examFrom?e.testRealFilter(t.examFrom):"","\uff09"):"")):J.a.createElement("span",null,a+1+"."),n=e.state.showAnswer;if("2"===t.testForm){if(n){var o=t.courseTestBlankAnwser,c=t.stem;return o.filter((function(e){return 1===e.standardFlag})).forEach((function(e){c=c.replace("___".concat(e.blankId,"___"),'<span class="blank-show-anwser">&nbsp;&nbsp;'.concat(e.anwserText,"&nbsp;&nbsp;</span>"))})),J.a.createElement("div",null,r,J.a.createElement("span",{dangerouslySetInnerHTML:{__html:c}}))}return J.a.createElement("div",null,r,J.a.createElement("span",{dangerouslySetInnerHTML:{__html:t.stem.replace(/___.*?___/g,"______")}}))}return J.a.createElement("div",null,r,J.a.createElement("span",{dangerouslySetInnerHTML:{__html:t.stem}}))},e.goDetail=function(){if(e.state.testBasketIdList.length<=0)I.a.warning("\u8bd5\u9898\u7bee\u4e3a\u7a7a,\u8bf7\u6dfb\u52a0\u8bd5\u9898\u5230\u8bd5\u9898\u7bee\u540e\u91cd\u8bd5!");else{var t,a=e.props.location.search,s=a?a.split("?")[1]:"",r="";s?(t=s.includes("%")?decodeURI(s):s,"courseDirectory"==(r=JSON.parse(t)).backTypeCourse?r.backType="questionBankCour":r.backType="questionBank"):r={backType:"questionBank"};var n={subjectId:e.state.subjectId,stageId:e.state.stageId,paramData:encodeURI(JSON.stringify(r))};e.props.history.push("/teching/group-centers-new/1/0?".concat(encodeURI(JSON.stringify(n))))}},e.addressVisibleChange=function(t){e.setState({addressVisible:t})},e.examYearVisibleChange=function(t){e.setState({examYearVisible:t})},e.testSourceVisibleChange=function(t){e.setState({testSourceVisible:t})},e.testSourceFilter=function(t){if(""===t)return"\u6765\u6e90";var a=e.state,s=(a.testSourceList,a.unitListAll),r={};return s.forEach((function(e){return r[e.id]=e.unitName})),r[t]},e.resourceNameSearch=function(t){e.setState({pageNum:1,resourceName:t.replace(/(^\s*)|(\s*$)/g,"")},(function(){e.getCourseTestList()}))},e.searchChange=function(t){e.setState({searchValue:t.target.value},(function(){e.setState({pageNum:1,resourceName:e.state.searchValue.replace(/(^\s*)|(\s*$)/g,"")},(function(){e.getCourseTestList()}))}))},e.resourceNameSearchSchool=function(t){e.setState({pageNum:1,resourceName:t.replace(/(^\s*)|(\s*$)/g,"")},(function(){e.getCourseTestList()}))},e.searchChangeSchool=function(t){e.setState({searchValueSchool:t.target.value},(function(){e.setState({pageNum:1,resourceName:e.state.searchValueSchool.replace(/(^\s*)|(\s*$)/g,"")},(function(){e.getCourseTestList()}))}))},e}return Object(x.a)(s,[{key:"randomkey",value:function(){return(Math.random(1e5)+"").replace(/^0\./,"")}},{key:"componentWillMount",value:function(){this.setState({iSGoHomeWork:!!sessionStorage.getItem("iSGoHomeWork")&&JSON.parse(sessionStorage.getItem("iSGoHomeWork"))})}},{key:"componentDidMount",value:function(){var e,t,a=this,s=this.props.location.search,r="";s&&(t=(e=s.split("?")[1]).includes("%")?decodeURI(e):e,r=JSON.parse(t).xzType);var n=sessionStorage.getItem("resourceLibraryKeys");if(n){var o=n.split(",")[0],c=n.split(",")[1];this.setState({keys:o,level:c})}this.getExamYearList(5),this.setState({userId:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).user.id:"",myUnitId:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).user.unitId:"",historyType:r},(function(){a.getMyStageList()})),this.getTestIdList(),this.getDicList({groupName:"testForm"}),this.testDiff({groupName:"testDiff"}),this.testCate({groupName:"testCate"})}},{key:"getProvince",value:function(){var e=Object(N.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.w)();case 2:(t=e.sent)&&t.length>0&&this.setState({provinceData:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUnitListByKeyWord",value:function(){var e=Object(N.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)(t);case 2:a=e.sent,this.setState({unitList:a}),t||this.setState({unitListAll:a});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getExamYearList",value:function(e){for(var t=(new Date).getFullYear(),a=[],s=0;s<e;s++){var r={value:t-s};r.key=s===e-1?"\u66f4\u65e9":t-s,a.push(r)}this.setState({examYearList:a})}},{key:"getSubCanton",value:function(){var e=Object(N.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.w)(t);case 2:a=e.sent,this.setState({region:a});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDicList",value:function(){var e=Object(N.a)(E.a.mark((function e(t){var a,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.o)(t);case 2:a=e.sent,s={},a.forEach((function(e){s[e.value]=e.text})),this.setState({testForm:a,testFormMap:s});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"testDiff",value:function(){var e=Object(N.a)(E.a.mark((function e(t){var a,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.o)(t);case 2:a=e.sent,s={},a.forEach((function(e){s[e.value]=e.title})),this.setState({testDiff:a,testDiffMap:s});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"testCate",value:function(){var e=Object(N.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.o)(t);case 2:a=e.sent,this.setState({testCate:a});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"testReal",value:function(){var e=Object(N.a)(E.a.mark((function e(){var t,a,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(t=this.state.stageId)){e.next=5;break}e.t0=[],e.next=8;break;case 5:return e.next=7,Object(H.i)(t);case 7:e.t0=e.sent;case 8:a=e.t0,s={},a.forEach((function(e){s[e.id]=e.typeName})),this.setState({testReal:a,testRealMap:s});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTestIdList",value:function(){var e=Object(N.a)(E.a.mark((function e(){var t,a,s,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,a=t.subjectId,s=t.stageId,e.next=3,Object(H.h)({subjectId:a,stageId:s});case 3:r=e.sent,this.setState({testBasketIdList:r});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTestFormList",value:function(){var e=Object(N.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,t.subjectId,t.stageId,e.next=3,Object(H.g)({createUserId:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).user.id:""});case 3:a=e.sent,this.setState({testFormList:a});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveTestBasket",value:function(e,t,a){var s=this,r=this.state,n=r.testBasketIdList,o=r.testBasketMax,c=r.stageId,i=r.subjectId;if(n.length>=o)return I.a.error("\u8bd5\u9898\u7bee\u53ea\u80fd\u6dfb\u52a040\u9053\u9898\uff01");Object(H.k)({testId:e,subjectId:i,stageId:c,testFormName:t}).then((function(e){s.getTestFormList(),s.setState({testBasketIdList:e})}))}},{key:"getCourseTestList",value:function(){var e=Object(N.a)(E.a.mark((function e(){var t,a,s,r,n,o,c,i,u,l,m,d,h,p,g;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,a=t.pageNum,s=t.pageSize,r=t.stageId,n=t.orderAscfield,o=t.orderDescfield,c=t.examTypeId,i=t.searchValue,u=t.searchValueSchool,l=t.level,m=t.keys,d=t.schoolQuestionBank_1,h=t.schoolQuestionBank_2,p={pageNum:a,pageSize:s,examTypeId:c||m,level:l||l,stageId:r,testForm:sessionStorage.getItem("schoolQuestionBank_1")?sessionStorage.getItem("schoolQuestionBank_1"):d,difficulty:sessionStorage.getItem("schoolQuestionBank_2")?sessionStorage.getItem("schoolQuestionBank_2"):h,orderAscfield:n,orderDescfield:o,schoolName:u,stem:i,courseSchoolFlag:"1",courseCloudFlag:"",courseCollectFlag:""},e.next=4,Object(H.e)(p);case 4:g=e.sent,this.setState({courseTestList:g?g.data:[],total:g?g.total:""});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMyStageList",value:function(){var e=Object(N.a)(E.a.mark((function e(){var t,a,s,r,n=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.u)();case 2:t=e.sent,(a=t&&t.length>0?t.map((function(e){return Object(O.a)(Object(O.a)({},e),{},{subjectName:e.stageName,id:e.stageId})})):"")&&(s="",r=sessionStorage.getItem("resourceBookId"),s=r||(a&&a[0]?a[0].stageId:""),this.setState({stageId:a.length?a[0].stageId:"",subjectList:a,bookId:s},(function(){var e=sessionStorage.getItem("resourceParentKeys");e=e?e.split(","):[],n.state.resourceParentKeys=e,e&&e.length>0&&(n.state.stageId=s,e.splice(e.indexOf("0"),1),n.onLoadData(1,e)),n.state.resourceParentKeys.push(0),n.state.randomkey=n.randomkey(),n.getCourseTestList()})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCourseListTree",value:function(){var e=Object(N.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.bookId)){e.next=7;break}return e.next=4,Object(U.d)({bookId:t});case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=[];case 8:a=e.t0,this.setState({courseTree:a});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getExamTypeTreeList",value:function(){var e=Object(N.a)(E.a.mark((function e(t,a){var s,r,n,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.state,r=s.bookId,n=0!=(n=s.seniorId)?n:"",!r){e.next=8;break}return e.next=5,Object(U.f)({bookId:r,seniorId:n});case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:o=e.t0,this.setState({courseTree:o,defaultKeys:o&&o.length>0?o[0].id:""});case 11:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getCourseListTreeNew",value:function(){var e=Object(N.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.bookId)){e.next=7;break}return e.next=4,Object(U.e)({bookId:t});case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=[];case 8:a=e.t0,this.setState({courseTree:a});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateTreeData",value:function(e,t,a){var s=this;return e.map((function(e){return e.id===t?(0==e.hasOwnProperty("children")&&(e.children=[]),Object(O.a)(Object(O.a)({},e),{},{children:a})):0==e.bottom?(0==e.hasOwnProperty("children")&&(e.children=[]),Object(O.a)(Object(O.a)({},e),{},{children:s.updateTreeData(e.children,t,a)})):e}))}},{key:"onLoadData",value:function(){var e=Object(N.a)(E.a.mark((function e(t,a){var s,r,n,o,c,i,u=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=!0,r=this.state,n=r.bookId,o=r.seniorId,c="",1==t?(o=a.join(","),s=!1,c=a[0]):(0==(c=a.props.eventKey)&&(c=""),this.state.seniorId=c,o=c,s=a.props.expanded),0!=s){e.next=14;break}if(!o||0==o){e.next=11;break}return e.next=8,Object(U.f)({bookId:n,seniorId:o});case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=[];case 12:return i=e.t0,e.abrupt("return",new Promise((function(e){a.children?e():setTimeout((function(){console.log("--------------------",u.state.courseTree,c,i);var a=u.updateTreeData(u.state.courseTree,c,i);1==t&&(u.state.randomkey=u.randomkey()),u.setState({courseTree:Object(b.a)(a),defaultKeys:a&&a.length>0?a[0].id:""}),e(),console.log("--------------------1111111111111",u.state.courseTree)}),1e3)})));case 14:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,s=(t.activeKey,t.courseTestList),r=t.total,n=t.pageNum,c=t.pageSize,u=(t.myCourseList,t.subjectList),m=t.courseTree,h=(t.isObligation,t.isOrdinary,t.testDetail),g=t.testRealMap,y=t.testDiffMap,k=t.AnalyzeTestModal,b=t.ErrorTestModal,C=t.similarTestModal,I=t.addTestModal,T=t.testForm,E=t.testDiff,N=(t.testCate,t.testReal,t.region,t.showAnswer),O=t.testId,j=t.bookId,x=t.testBasketIdList,L=t.testBasketMax,F=t.examYearList,w=t.sortSet,B=(t.selectCatalogId,t.addressVisible,t.examYearVisible,t.unitList),M=(t.testSourceList,t.testSourceValue),_=(t.testSourceVisible,t.provinceData),z=t.cityData,D=t.countyData,A=(t.resourceProvinceName,t.resourceCityName,t.resourceCountyName,t.examYearName,t.testRealCheck,t.searchValue),P=(t.searchValueSchool,t.lineValue),Y=t.keys,K=t.schoolQuestionBank_1,q=t.schoolQuestionBank_2,U=t.resourceParentKeys,G=t.historyType,H=t.iSGoHomeWork,W=s&&s.length>0?s.map((function(t,a){return J.a.createElement(p.a,{key:a,title:e.getStem(t,a,0),bordered:!1},"1"===t.testForm||"3"===t.testForm||"4"===t.testForm?J.a.createElement(S.a,{type:"flex",className:"question-select",gutter:20}):"","8"===t.testForm||"5"===t.testForm||"6"===t.testForm||"7"===t.testForm?J.a.createElement("div",{className:"question-select multiple-question"}):"",N?J.a.createElement("div",null,null==t.courseTestEasyAnwser||""===t.courseTestEasyAnwser?"":t.courseTestEasyAnwser.anwserText):"",J.a.createElement(S.a,{type:"flex",justify:"space-around",className:"question-container"},J.a.createElement(v.a,{span:15,className:"question-bottom"},J.a.createElement("div",{className:"question-bottom-left"},J.a.createElement("div",{className:"question-bottom-doc"},J.a.createElement("span",{title:t.createTime},"\u521b\u5efa\u65f6\u95f4\uff1a",t.createTime?t.createTime.substring(0,10):""),J.a.createElement("span",null,"\u5f15\u7528\uff1a",t.usedNum),J.a.createElement("span",null,"\u6536\u85cf\uff1a",t.collectNum),J.a.createElement("span",null,"\u9898\u578b\uff1a",1==t.testForm?"\u9009\u62e9\u9898":2==t.testForm?"\u586b\u7a7a\u9898":3==t.testForm?"\u591a\u9009\u9898":4==t.testForm?"\u5224\u65ad\u9898":5==t.testForm?"\u4f5c\u56fe\u9898":6==t.testForm?"\u5b9e\u9a8c\u63a2\u7a76\u9898":7==t.testForm?"\u8ba1\u7b97\u9898":8==t.testForm?"\u7efc\u5408\u80fd\u529b\u9898":9==t.testForm?"\u89e3\u7b54\u9898":""),J.a.createElement("span",null,"\u96be\u5ea6\uff1a",e.testDiffFilter(t.difficulty)),J.a.createElement("span",{title:t.unitName},"\u6765\u6e90\uff1a",t.unitName)))),J.a.createElement(v.a,{span:9,className:"question-back-edit"},J.a.createElement("span",{type:"primary",style:{marginRight:"10"},onClick:function(){return e.analyzeTestModal(t)}},"\u67e5\u770b\u89e3\u6790"),4==e.state.activeKey?J.a.createElement("span",{onClick:function(){return e.collectChange(t.resourceId)},type:"primary",style:{marginRight:"5"}},"\u53d6\u6d88\u6536\u85cf"):"",J.a.createElement("span",{type:"primary",onClick:function(){return e.collectChange(t.resourceId)}},"0"===t.collectFlag?"\u6536\u85cf":"\u53d6\u6d88\u6536\u85cf"),x.includes(t.id)?J.a.createElement(f.a,{icon:"minus",onClick:function(){return e.saveTestBasket(t.id,e.testFormFilter(t.testForm),t.testForm)}},"\u8bd5\u9898\u7bee"):J.a.createElement(f.a,{icon:"plus",onClick:function(){return e.saveTestBasket(t.id,e.testFormFilter(t.testForm),t.testForm)}},"\u8bd5\u9898\u7bee"))))})):"";R.a,this.bookChange,u&&u.length>0&&u.map((function(e,t){return J.a.createElement(ie,{key:t,value:e.stageId},e.stageName)})),m&&m.length&&(Q.a,this.state.randomkey,this.classifyCheck,this.onLoadData.bind(this,""),m&&this.renderTreeNodes(m)),d.a.Group,this.testSourceChange.bind(this),d.a.Button,B&&B.length>0&&B.map((function(e,t){return J.a.createElement(d.a.Button,{key:e.id,value:e.id},e.unitName)})),d.a.Group,this.examYearChange.bind(this),d.a.Button,F&&F.length>0&&F.map((function(e,t){return J.a.createElement(d.a.Button,{key:e.value,value:e},e.key)})),d.a.Group,this.onProvinceChange.bind(this),d.a.Button,_&&_.length>0&&_.map((function(e,t){return J.a.createElement(d.a.Button,{key:e.value,value:e},e.title)})),z&&z.length>0&&(d.a.Group,this.onCityChange.bind(this),d.a.Button,z&&z.length>0&&z.map((function(e,t){return J.a.createElement(d.a.Button,{key:e.value,value:e},e.title)}))),D&&D.length>0&&(d.a.Group,this.onCountyChange.bind(this),d.a.Button,D&&D.length>0&&D.map((function(e,t){return J.a.createElement(d.a.Button,{key:e.value,value:e},e.title)})));return J.a.createElement("div",{className:"question-bank teach-main"},J.a.createElement("div",{className:"teach-main-box"},"xz"==G?J.a.createElement(X.a,null):J.a.createElement(ee.a,{navName:H?"complete-test":"question-bank"}),J.a.createElement("div",{className:"teach-main-cont teach-main-cont-l"},J.a.createElement(S.a,{className:"complete-title"},J.a.createElement(v.a,{span:22},J.a.createElement("span",null,H?"\u9009\u62e9\u8bd5\u9898":"\u8bd5\u9898\u5e93"),J.a.createElement(ne.a,{defaultKeys:"2"})),J.a.createElement(v.a,{span:2,className:"ant-col-resource"},H?J.a.createElement(f.a,{onClick:function(){e.props.history.push("/teching/complete-test")},style:{margin:0}},"\u53d6\u6d88\u6dfb\u52a0"):J.a.createElement(oe.b,{to:"/teaching/question-bank/create-test"},J.a.createElement(f.a,null,"\u6dfb\u52a0\u8bd5\u9898")))),J.a.createElement("div",{style:{marginBottom:30}},J.a.createElement(S.a,{className:"teach-main-content-l"},J.a.createElement(v.a,{className:"paper-right-top"},J.a.createElement("div",{className:"paper-right-menu paper-right-menu-lh paper-right-menu-l"},J.a.createElement(S.a,{className:"paper-common"},J.a.createElement(v.a,{className:"paper-year"},"\u9898\u578b"),J.a.createElement(v.a,null,J.a.createElement(d.a.Group,{onChange:this.testFormChange.bind(this),value:K},J.a.createElement(d.a.Button,{value:""},"\u5168\u90e8"),T&&T.length>0?T.filter((function(e){return"8"!=e.value})).map((function(e,t){return J.a.createElement(d.a.Button,{key:e.text,value:e.value},e.text)})):""))),J.a.createElement(S.a,{className:"paper-common"},J.a.createElement(v.a,{className:"paper-year"},"\u96be\u5ea6"),J.a.createElement(v.a,null,J.a.createElement(d.a.Group,{onChange:this.testDiffChange.bind(this),value:q},J.a.createElement(d.a.Button,{value:""},"\u5168\u90e8"),E&&E.length>0?E.map((function(e,t){return J.a.createElement(d.a.Button,{key:e.text,value:e.value},e.text)})):"")))),J.a.createElement("div",{className:"paper-right-bottom"},J.a.createElement(S.a,{className:"content-top"},J.a.createElement("div",{className:"paper-common-btn"},J.a.createElement(f.a,{type:"zh"===w.value?"primary":"",onClick:function(){return e.zhClick()}},"\u521b\u5efa\u65f6\u95f4","zh"===w.value?J.a.createElement(l.a,{type:w.zhOrder?"down":"up"}):""),J.a.createElement(f.a,{type:"zj"===w.value?"primary":"",onClick:function(){return e.zjClick()}},"\u5f15\u7528\u91cf","zj"===w.value?J.a.createElement(l.a,{type:w.zjOrder?"down":"up"}):""),J.a.createElement(f.a,{type:"nd"===w.value?"primary":"",onClick:function(){return e.ndClick()}},"\u6536\u85cf\u91cf","nd"===w.value?J.a.createElement(l.a,{type:w.ndOrder?"down":"up"}):"")),J.a.createElement("div",{className:"pape-all pape-all-l"},J.a.createElement(le,{placeholder:"\u8bf7\u8f93\u5165\u9898\u5e72",value:A,onSearch:function(t){return e.resourceNameSearch(t)},onChange:this.searchChange}),J.a.createElement("div",null,"\u5171\u8ba1",J.a.createElement("span",{className:"paper-number"},r),"\u9053\u76f8\u5173\u8bd5\u9898"))),s&&s.length>0?J.a.createElement("div",null,W,r?J.a.createElement("div",{className:"pagination-style-l"},J.a.createElement(i.a,{showSizeChanger:!0,onShowSizeChange:this.onShowSizeChange,onChange:this.onPageNumChange,defaultCurrent:1,current:n,pageSize:c,total:r,showTotal:function(e){return"\u5171 "+e+" \u6761"}})):""):J.a.createElement(o.a,{className:"empty-l",style:{marginTop:"5%"}})))),H?J.a.createElement("div",{className:"aRside",onClick:function(){return e.goDetail()}},J.a.createElement("div",{className:"aRside-t"},J.a.createElement("img",{className:"user-img",src:a(929),alt:""}),J.a.createElement("span",{className:"aRside-tnum"},x?x.length:0)),J.a.createElement("div",{className:"aRside-name"},"\u8fdb ",J.a.createElement("br",null),"\u5165 ",J.a.createElement("br",null)," \u4f5c ",J.a.createElement("br",null),"\u4e1a ",J.a.createElement("br",null)),J.a.createElement(l.a,{type:"right"})):"")),J.a.createElement(V.a,{className:"modal-btn-bank btn-lan modal-style-lll",visible:k,title:"\u8bd5\u9898\u8be6\u60c5",onOk:this.handleAccredit,onCancel:this.analyzeCancel,keyboard:!1,maskClosable:!1,footer:[J.a.createElement(f.a,{key:"back",onClick:this.analyzeCancel},"\u5173\u95ed")]},J.a.createElement(te.default,{testDetail:h,testRealMap:g,testBasketIdList:x,testBasketMax:L,saveTestBasket:this.saveTestBasket.bind(this),wrappedComponentRef:function(t){e.AnalysisTestFrom=t}})),J.a.createElement(V.a,{className:"modal-btn",visible:b,title:"\u8bd5\u9898\u7ea0\u9519",onOk:this.handleAccredit,onCancel:this.errorTestCancel,keyboard:!1,maskClosable:!1,footer:[J.a.createElement(f.a,{key:"submit",type:"primary",onClick:this.errorTestSave},"\u786e\u8ba4"),J.a.createElement(f.a,{key:"back",onClick:this.errorTestCancel},"\u8fd4\u56de")]},J.a.createElement(ae.default,{wrappedComponentRef:function(t){e.ErrorTestForm=t}})),J.a.createElement(V.a,{className:"modal-btn",width:"850px",visible:C,title:"\u76f8\u4f3c\u9898",onOk:this.handleAccredit,onCancel:this.similarTestCancel,keyboard:!1,maskClosable:!1,footer:[J.a.createElement(f.a,{key:"submit",type:"primary",onClick:this.similarTestCancel},"\u786e\u8ba4"),J.a.createElement(f.a,{key:"back",onClick:this.similarTestCancel},"\u8fd4\u56de")]},J.a.createElement(se.default,{testId:O,testRealMap:g,testDiffMap:y,testBasketIdList:x,testBasketMax:L,saveTestBasket:this.saveTestBasket.bind(this),wrappedComponentRef:function(t){e.SimilarTestFrom=t}})),J.a.createElement(V.a,{className:"modal-btn",visible:I,title:"\u52a0\u5165\u6211\u7684\u9898\u5e93",onOk:this.handleAccredit,onCancel:this.addTestCancel,keyboard:!1,maskClosable:!1,footer:[J.a.createElement(f.a,{key:"submit",type:"primary",onClick:this.courseTestSave},"\u786e\u8ba4"),J.a.createElement(f.a,{key:"back",onClick:this.addTestCancel},"\u8fd4\u56de")]},J.a.createElement(re.default,{catalogType:!0,info:P,wrappedComponentRef:function(t){e.AddTestForm=t}}))))}}]),s}(q.Component)),de=r.a.create()(me);t.default=de}}]);